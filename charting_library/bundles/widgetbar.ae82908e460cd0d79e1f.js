(window.webpackJsonp=window.webpackJsonp||[]).push([["widgetbar"],{"/dUa":function(t,e,i){"use strict";i.r(e);var s=i("Eyy1"),n=i("8woN"),a=i.n(n),o=i("sFgq"),r=i("IWXC");var h=i("b5Gw"),l=i("Kxc7"),d=i("EQkL");function c(t){return function(t){let e,i=0;if(0===t.length)return i;for(var s=0;s<t.length;s++)e=t.charCodeAt(s),i=(i<<5)-i+e,i&=i;return i}(t.title+t.published)}var u=i("txPx");const g=new Set([".","۔","܁","܂","…","、","。","．",",",":",";","-","ー"," ","(",")"]);function p(t,e){if(e<=0)return t;const i=t.length;if(i<=e)return t;if(i>e){const i=t[e],s=t[e-1];if(g.has(i)&&!g.has(s))return m(t,e)}let s=null;for(let i=e-1;i>0;i--){const e=t[i];if(g.has(e))s=i;else if(null!==s)return m(t,s)}return t+"…"}function m(t,e){return t.slice(0,e)+"…"}i("IS8I");var _=i("JHPQ");i.d(e,"WidgetBarNews",(function(){return v}));const w=Object(u.getLogger)("News.Widget");class v{constructor(t){this.widgetName="widgetbar",this._newsScrollIterator=null,this._newsDiffResolver=null,this._updateWhenVisible=null,this._pendingNewsRequest=null,this._updateIntervalHandle=null,this._needsFullUpdate=!0,this._dataProvider=null,this._resize=this.resize.bind(this),this._onSymbolChange=this.onSymbolChange.bind(this),this._quoteSymbol=null,this._quoteMetaInfo=null,this._shortName=null,this._bridge=t,this._widgetTitle=Object(s.ensureNotNull)(this._bridge.header.querySelector(".widgetbar-widgettitle")),this._container=t.container,this._prepareLayout(this._container);const e=function(){if(l.enabled("charting_library_base"))return new d.LibraryNewsProvider}();e&&(this._dataProvider=e),this._bridge.symbol.subscribe(this._onSymbolChange,{callWithLast:!0}),window.loginStateChange.subscribe(this,this._onLoginChange)}refresh(){this.update(!0)}update(t){if(!this._dataProvider)return;if(!this._bridge.visible.value())return void(null===this._updateWhenVisible&&(this._updateWhenVisible=t=>{t&&(null!==this._updateIntervalHandle&&this._setUpdateInterval(),this._bridge.visible.unsubscribe(this._updateWhenVisible),this._updateWhenVisible=null,this.update())},this._bridge.visible.subscribe(this._updateWhenVisible),this._updateIntervalHandle&&clearInterval(this._updateIntervalHandle)));const e=this._quoteMetaInfo;if(!e)return this._clear(),void this._stopLoading();const i=e.short_name;this._needsFullUpdate=t||i!==this._shortName,this._shortName=i,this._needsFullUpdate&&(this._startLoading(),this._updateIntervalHandle&&clearInterval(this._updateIntervalHandle),this._setUpdateInterval()),this._pendingNewsRequest&&this._pendingNewsRequest.cancel(),this._pendingNewsRequest=Object(h.makeCancelable)(this._dataProvider.getNews(e)),this._pendingNewsRequest.promise.then(t=>{this._pendingNewsRequest=null,this._stopLoading(),this._setTitle(t.title),this.updateData(t.newsItems)}).catch(t=>{if(!Object(h.isCancelled)(t))throw this._pendingNewsRequest=null,this._stopLoading(),t})}updateData(t){var e;if(t&&t.length)if(this._needsFullUpdate){this._clear(),this._newsScrollIterator=function(t,e){if(!Number.isInteger(e))throw new TypeError("Chunks size must be an integer")
;if(e<=0)throw new RangeError("Chunk size must be a positive number");const i=t.slice();return{next(){const t=i.splice(0,e);return{value:t,done:!t.length}}}}(t,20);const i=this._newsScrollIterator.next().value,s=c(i[0]);this._newsDiffResolver=(e=s,{getDiff(t){if(0===t.length)return[];const i=t.findIndex(t=>c(t)===e);return e=c(t[0]),t.slice(0,-1===i?t.length:i)}}),this._renderItems(i,!1)}else{if(!this._newsDiffResolver)return void w.logError("Attempt to perform partial update before full update was committed");const e=this._newsDiffResolver.getDiff(t);this._renderItems(e,!0)}}resize(){this._scroll.resize()}highlight(t){t.classList.add(_["news-item--highlight"]);const e=()=>{t.classList.remove(_["news-item--highlight"]),t.removeEventListener("animationend",e)};t.addEventListener("animationend",e)}onSymbolChange(t){if(a.a.shortName(t)===this._shortName)return;const e=Object(r.getQuoteSessionInstance)("full");if(this._quoteSymbol&&e.unsubscribe(this._bridge.id,this._quoteSymbol),this._quoteMetaInfo=null,!t)return void(this._quoteSymbol=null);this._quoteSymbol=t,this._needsFullUpdate&&this.update(),this._bridge.clearNotifications();let i=!1;e.subscribe(this._bridge.id,t,s=>{i||("permission_denied"===s.status&&s.values&&s.values.alternative?this.onSymbolChange(s.values.alternative):s.values&&s.values.short_name&&(this._quoteMetaInfo={pro_name:s.values.pro_name,short_name:s.values.short_name,type:s.values.type,typespecs:s.values.typespecs,exchange:s.values.exchange},this.update(),i=!0,setTimeout(()=>{e.unsubscribe(this._bridge.id,t)},0)))})}destroy(){this._quoteSymbol&&Object(r.getQuoteSessionInstance)("full").unsubscribe(this._bridge.id,this._quoteSymbol),this._updateIntervalHandle&&(clearInterval(this._updateIntervalHandle),this._updateIntervalHandle=null),this._scroll.scrolltoend.unsubscribe(this,this._onScrollToEnd),this._updateWhenVisible&&this._bridge.visible.unsubscribe(this._updateWhenVisible),this._bridge.height.unsubscribe(this._resize),this._bridge.visible.unsubscribe(this._resize),this._bridge.symbol.unsubscribe(this._onSymbolChange),window.loginStateChange.unsubscribe(this,this._onLoginChange)}_setTitle(t){this._dataProvider&&(this._widgetTitle.textContent=t)}_clear(){this._clearListUI(),this._scroll.scrolltoend.unsubscribe(this,this._onScrollToEnd),this._scroll.scrollToStart(),this._scroll.scrolltoend.subscribe(this,this._onScrollToEnd)}_prepareLayout(t){this._container=t;const e=this._widget=document.createElement("div");e.classList.add("tv-news"),e.addEventListener("contextmenu",t=>{"a"!==t.target.tagName.toLowerCase()&&t.preventDefault()}),this._container.appendChild(e);const i=this._data=document.createElement("div");i.classList.add("ns-data"),i.setAttribute("data-name","news_list"),e.appendChild(i),this._scroll=new o.a(this._widget,this._data),this._bridge.height.subscribe(this._resize),this._bridge.visible.subscribe(this._resize)}_setUpdateInterval(){if(!this._dataProvider)return;const t=this._dataProvider.timeout();t&&(this._updateIntervalHandle=setInterval(this.update.bind(this),t))}
_renderItems(t,e=!1){if(!this._dataProvider)return;const i=document.createDocumentFragment();for(const s of t){const t={...s};t.shortDescription=p(s.shortDescription,170);const n=this._dataProvider.renderItem(t);this._dataProvider.addClickHandlers(s,n),e&&this.highlight(n),i.appendChild(n)}e?this._data.prepend(i):this._data.append(i)}_onScrollToEnd(){this._newsScrollIterator&&this._renderItems(this._newsScrollIterator.next().value,!1)}_onLoginChange(){window.is_authenticated||this.update()}_startLoading(){this._data.classList.add("loading")}_stopLoading(){this._data.classList.remove("loading")}_clearListUI(){this._data.innerHTML=""}}},"1Pr8":function(t,e,i){t.exports={button:"button-DABaJZo4",hover:"hover-DABaJZo4",hoverMask:"hoverMask-DABaJZo4",icon:"icon-DABaJZo4",counterRow:"counterRow-DABaJZo4",counter:"counter-DABaJZo4",isGrayed:"isGrayed-DABaJZo4",isActive:"isActive-DABaJZo4",isTab:"isTab-DABaJZo4"}},"1TxM":function(t,e,i){"use strict";i.d(e,"c",(function(){return h})),i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return d}));var s=i("q1tI"),n=i.n(s),a=i("17x9"),o=i.n(a);const r=n.a.createContext({});function h(t,e){o.a.checkPropTypes(e,t,"context","RegistryContext")}function l(t){const{validation:e,value:i}=t;return h(i,e),n.a.createElement(r.Provider,{value:i},t.children)}function d(){return r}},"1WEt":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m18 18v-.5c0-1.2.6-2 1.5-2.7.8-.5 2-.8 3-.8s2.2.3 3 .8c.9.6 1.5 1.5 1.5 2.7a4 4 0 0 1-1.3 2.8l-2.3 2c-.3.3-.4.6-.4 1.2v.5h-1v-.5c0-.8.2-1.4.6-1.9l2.4-2c.6-.7 1-1.3 1-2.1a2 2 0 0 0-1-1.8c-.7-.5-1.6-.7-2.5-.7-1 0-1.8.2-2.5.7-.6.4-1 1-1 1.8v.5m3.5 8a1 1 0 0 0 0 5 1 1 0 0 0 0-5m0 1a1 1 0 0 1 0 3 1 1 0 0 1 0-3m0-17a1 1 0 0 0 0 25 1 1 0 0 0 0-25m0 1a1 1 0 0 1 0 23 1 1 0 0 1 0-23"/></svg>'},"5AaZ":function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var s=i("q1tI"),n=i.n(s),a=i("TSYQ"),o=i.n(a),r=i("cvc5"),h=i("Iivm"),l=i("//lZ"),d=i("9uLv"),c=i("uJ8n"),u=i("Vike");class g extends n.a.PureComponent{constructor(t){super(t),this._scroll=null,this._handleScrollTop=()=>{this.animateTo(Math.max(0,this.currentPosition()-(this.state.heightWrap-50)))},this._handleScrollBot=()=>{this.animateTo(Math.min((this.state.heightContent||0)-(this.state.heightWrap||0),this.currentPosition()+(this.state.heightWrap-50)))},this._handleResizeWrap=({height:t})=>{this.setState({heightWrap:t})},this._handleResizeContent=({height:t})=>{this.setState({heightContent:t})},this._handleScroll=()=>{const{onScroll:t}=this.props;t&&t(this.currentPosition(),this.isAtTop(),this.isAtBot()),this._checkButtonsVisibility()},this._checkButtonsVisibility=()=>{const{isVisibleTopButton:t,isVisibleBotButton:e}=this.state,i=this.isAtTop(),s=this.isAtBot();i||t?i&&t&&this.setState({isVisibleTopButton:!1}):this.setState({isVisibleTopButton:!0}),s||e?s&&e&&this.setState({isVisibleBotButton:!1}):this.setState({isVisibleBotButton:!0})},this.state={heightContent:0,heightWrap:0,isVisibleBotButton:!1,isVisibleTopButton:!1}}
componentDidMount(){this._checkButtonsVisibility()}componentDidUpdate(t,e){e.heightWrap===this.state.heightWrap&&e.heightContent===this.state.heightContent||this._handleScroll()}currentPosition(){return this._scroll?this._scroll.scrollTop:0}isAtTop(){return this.currentPosition()<=1}isAtBot(){return this.currentPosition()+this.state.heightWrap>=this.state.heightContent-1}animateTo(t,e=d.b){const i=this._scroll;i&&Object(l.doAnimate)({onStep(t,e){i.scrollTop=e},from:i.scrollTop,to:Math.round(t),easing:d.c.easeInOutCubic,duration:e})}render(){const{children:t,isVisibleScrollbar:e,isVisibleFade:i,isVisibleButtons:s,onMouseOver:a,onMouseOut:l}=this.props,{heightContent:d,heightWrap:g,isVisibleBotButton:p,isVisibleTopButton:m}=this.state;return n.a.createElement(r,{whitelist:["height"],onMeasure:this._handleResizeWrap},n.a.createElement("div",{className:c.wrap,onMouseOver:a,onMouseOut:l},n.a.createElement("div",{className:o()(c.scrollWrap,{[c.noScrollBar]:!e}),onScroll:this._handleScroll,ref:t=>this._scroll=t},n.a.createElement(r,{onMeasure:this._handleResizeContent,whitelist:["height"]},n.a.createElement("div",{className:c.content},t))),i&&n.a.createElement("div",{className:o()(c.fadeTop,{[c.isVisible]:m&&d>g})}),i&&n.a.createElement("div",{className:o()(c.fadeBot,{[c.isVisible]:p&&d>g})}),s&&n.a.createElement("div",{className:o()(c.scrollTop,{[c.isVisible]:m&&d>g}),onClick:this._handleScrollTop},n.a.createElement("div",{className:c.iconWrap},n.a.createElement(h.a,{icon:u,className:c.icon}))),s&&n.a.createElement("div",{className:o()(c.scrollBot,{[c.isVisible]:p&&d>g}),onClick:this._handleScrollBot},n.a.createElement("div",{className:c.iconWrap},n.a.createElement(h.a,{icon:u,className:c.icon})))))}}g.defaultProps={isVisibleScrollbar:!0}},"5qsH":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><g fill="none" stroke="currentColor"><path d="M14.5 27.5c0 4.97 3.03 8 8 8 4.97 0 8-3.03 8-8v-6a3 3 0 0 0-3-3h-10a3 3 0 0 0-3 3v6z"/><path stroke-linecap="square" d="M22.5 19v16"/><path d="M27.5 18.5a5 5 0 1 0-10 0m13 3h2a2 2 0 0 1 2 2V25m-4 2.5h2a2 2 0 0 1 2 2V31M29 32.5h1.5a2 2 0 0 1 2 2V36m-18-14.5h-2a2 2 0 0 0-2 2V25m4 2.5h-2a2 2 0 0 0-2 2V31m5.5 1.5h-1.5a2 2 0 0 0-2 2V36"/><g transform="translate(12 8)"><circle cx="2.5" cy="2.5" r="2"/><path d="M3.911 3.911L7 7"/></g><g transform="translate(26 8)"><circle cx="4.5" cy="2.5" r="2"/><path d="M3.115 3.885L0 7"/></g></g></svg>'},"8d0Q":function(t,e,i){"use strict";var s=i("q1tI");function n(){const[t,e]=Object(s.useState)(!1);return[t,{onMouseOver:function(t){a(t)&&e(!0)},onMouseOut:function(t){a(t)&&e(!1)}}]}function a(t){return!t.currentTarget.contains(t.relatedTarget)}function o(t){const[e,i]=Object(s.useState)(!1);return Object(s.useEffect)(()=>{const e=e=>{if(null===t.current)return;const s=t.current.contains(e.target);i(s)};return document.addEventListener("mouseover",e),()=>document.removeEventListener("mouseover",e)},[]),e}i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return o}))},
"9Qhg":function(t,e,i){},BH4H:function(t,e,i){"use strict";(function(e,s,n,a){var o=i("YFKU").t;i("9Qhg"),i("P5fv"),i("TdlR");var r=i("Eyy1").ensureNotNull,h=(o=i("YFKU").t,i("PT1i").linking),l=i("1AAW").combine,d=i("JWMC").trackEvent,c=i("e3/o"),u=i("/BH3"),g=i("TSYQ"),p=i("Fb/L").WidgetBarInternal,m=i("dkCg").RightToolbarRenderer,_=i("tBUM").WidgetBarTabButtonViewModel,w=i("jkvV").Hider,v=i("i8i4"),b=i("q1tI"),f=i("HySD"),y=i("N22A"),C=y.tradingService,B=y.waitTradingService,S=i("b5Gw").makeCancelable,T=i("ULlu").unwrap;i("e9Yb");var P=i("xrkQ"),W=parseInt(P["css-value-widgets-margin"]),x=i("FadI").delay;const H={title:o("Details"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,widgetClass:P.widget,headerClass:P.widgetHeader,margin:W},O=Object.assign({},H,{noHeaderSpace:!0,titleClass:P.widgetTitle});function M(t){t||(t={}),this.options=t,this._enforce=new Promise(t=>{this._load=t});const i=this.options.configuration;this._configuration=Promise.race([x(null,5e3),this._enforce]).then(()=>i()).then(t=>{var e=this.widgetConfig;return e.reuters_calendar.ctor=t.ReutersCalendarWidget,e.earnings_calendar.ctor=t.CalendarWidget&&t.CalendarWidget.Earnings,e.watchlist.ctor=t.Watchlist,e.hotlist.ctor=t.HotlistWidget,e.detail.ctor=t.Detail&&t.Detail.Widget,e.news.ctor=t.NewsWidget,e.chat.ctor=t.ChatWidget,e.messages.ctor=t.Messages&&t.Messages.Widget,e.messages_with_select.ctor=t.Messages&&t.Messages.Widget,e.notifications_following.ctor=t.NotificationsWidgets,e.notifications_user.ctor=t.NotificationsWidgets,e.publicchats.ctor=t.PublicChatsWidget,e.publicchats_with_select.ctor=t.PublicChatsWidget,e.notes.ctor=t.NotesWidget,e.alerts_manage.ctor=t.AlertsManageWidget,e.alerts_log.ctor=t.AlertsLogWidget,e.streams.ctor=t.StreamsWidget,e.datawindow.ctor=t.DataWindowWidget,e.object_tree.ctor=t.ObjectTreeWidget,t}),this.resizerBridge=t.resizerBridge,this.adaptive=!!t.adaptive,this.tradingPanelAccessor=t.tradingPanelAccessor;var s=this.resizerBridge;this._visible=l((function(t,e,i){return Boolean(t&&e&&i)}),s.width,s.height,s.visible),this.widgetConfig=e.extend(!0,{},M.widgetConfig),t.widgetConfig&&(this.widgetConfig=e.extend(!0,this.widgetConfig,t.widgetConfig)),this.layout=new L({widgetBar:this}),this._customization=t.customization,t.chartWidgetCollection&&(this.chartWidgetCollection=t.chartWidgetCollection),t.state?this.layout.demarshal(t.state):t.settingsPrefix&&(this._settingsPrefix=t.settingsPrefix+"",this.loadFromTVSettings()),t.readonly&&(this.readonly=!0),t.fixedMode&&(this.fixedMode=!0),t.showCloseButton&&(this.showCloseButton=!0),this.$container=e(this.resizerBridge.container.value()),this._internal=new p(this),this.createHTML(),this.initLayout(),loginStateChange.subscribe(this,this.onLoginStateChange),this.resizerBridge.width.subscribe(function(){this.layout.syncWidth()}.bind(this)),this.resizerBridge.height.subscribe(function(){this.layout.syncHeight()}.bind(this)),this.resizerBridge.visible.subscribe(function(t){this.layout.onVisibilityChange(t)}.bind(this)),this.resizerBridge.availWidth.subscribe(function(){
this.layout.requestOptimalWidth(),this.layout.updateResponsiveness()}.bind(this)),this._tradingServiceCancelable=S(B()),this._tradingServiceCancelable.promise.then(function(t){this._tradingServiceCancelable=null,t.onConnectionStatusChange.subscribe(this,this._onBrokerConnectionStatusChanged)}.bind(this))}M.widgetConfig={reuters_calendar:{title:o("Economic Calendar"),ctor:null,lazyLoad:!0,icon:"economic-calendar",options:{widgetType:"widgetbar"}},earnings_calendar:{title:o("Earnings Calendar"),ctor:null,lazyLoad:!0,icon:"earnings-calendar"},watchlist:{title:o("Watchlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,widgetClass:P.widget,headerClass:P.widgetHeader,margin:W,preloadDelay:6e4},hotlist:{title:o("Hotlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,widgetClass:P.widget,headerClass:P.widgetHeader,margin:W},detail:O,news:{title:o("Headlines"),ctor:null,noHeaderSpace:!0,widgetClass:P.widget,headerClass:P.widgetHeader,titleClass:P.widgetTitle,margin:W},chat:{title:o("Talks"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages:{title:o("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages_with_select:{title:o("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notifications_user:{title:o("Notifications"),ctor:null,options:{type:"user"},chartWidgetAllowed:!0},notifications_following:{title:o("Ideas Stream"),ctor:null,options:{type:"following"},chartWidgetAllowed:!0},datawindow:{title:o("Data Window"),ctor:null,chartWidgetAllowed:!0,chartWidgetRequired:!0},publicchats:{title:o("All Talks"),ctor:null,doNotClearNotifications:!0},publicchats_with_select:{title:o("All Talks"),ctor:null,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notes:{title:o("My Ideas"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},alerts_manage:{ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,noHeaderSpace:!0,widgetClass:P.widget,headerClass:P.widgetHeader,margin:W},alerts_log:{ctor:null,chartWidgetAllowed:!0,emptyHeader:!0,noHeaderSpace:!0,widgetClass:P.widget,headerClass:P.widgetHeader,margin:W},market_summary:{title:o("Market Summary"),ctor:null},object_tree:{title:o("Object tree. Multi-select drawings tools"),ctor:null,noHeader:!0,chartWidgetAllowed:!0,chartWidgetRequired:!0},streams:{title:o("Streams"),ctor:null,emptyHeader:!0,widgetClass:P.widget,headerClass:P.widgetHeader,margin:W,doNotClearNotifications:!0,doNotClearNotificationsOnVisibilityChange:!0}},M.svgIcons={base:i("dECE")},M.svgIcons["object-tree"]=i("aE/C"),M.svgIcons.datawindow=i("GNw3"),M._messageHandlers=[],M.postMessage=function(t,e){M._messageHandlers.forEach((function(i){i.handler(t,e)}))},M.onMessage=function(t){"function"==typeof t&&M._messageHandlers.push({handler:t,widget:this})},M.offMessage=function(t){if("function"==typeof t){const e=M._messageHandlers.findIndex(e=>e.handler===t);-1!==e&&M._messageHandlers.splice(e,1)}},M.prototype.destroy=function(){
null!==this._tradingServiceCancelable?(this._tradingServiceCancelable.cancel(),this._tradingServiceCancelable=null):r(C()).onConnectionStatusChange.unsubscribe(this,this._onBrokerConnectionStatusChanged);this._internal.destroy(),this._internal=null},M.prototype.isVisible=function(){var t=this.resizerBridge;return t.visible.value()&&t.height.value()&&t.width.value()},M.prototype.visible=function(){return this._visible},M.prototype.initLayout=function(){this.options.instantLoad&&this._load(),this._configuration.then(()=>{this.layout.startWidgets()}),0===this.layout.pages.length&&(this.layout.setMinimizedState(!0),this.layout.$handle.addClass("js-hidden")),this.layout.requestOptimalWidth(),this.layout.syncWidth(),this.layout.syncHeight(),this.layout.onVisibilityChange(),this.layout.updateResponsiveness()},M.prototype.loadWidgets=function(){this._widgetsLoadRequested||(this._widgetsLoadRequested=!0,this._load())},M.prototype.onLoginStateChange=function(t){t||window.is_authenticated&&(this.dropWidgetData(),this.refreshFromTVSettings())},M.prototype.dropWidgetData=function(){for(var t in this.widgetConfig)delete this.widgetConfig[t].data},M.prototype.refreshFromTVSettings=function(){this._settingsPrefix&&(this.layout&&this.layout.destroy(),this.layout=new L({widgetBar:this}),this.loadFromTVSettings(),this.layout.createHTML(),this.layout.$pages.appendTo(this.$wrap),this.layout.$tabs.appendTo(this.$wrap),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap),this.initLayout())},M.prototype.getWidgets=function(t){for(var e=[],i=0;i<this.layout.pages.length;++i)e=e.concat(this.layout.pages[i].getWidgets(t));return e},M.prototype.loadFromTVSettings=function(){if(this._settingsPrefix){try{this.migrateFromOld()}catch(t){console.error&&console.error(t)}var t=this.getLayoutState();t=this.mergeProperties(t),this.layout.demarshal(t,{settingsPrefix:this._settingsPrefix}),this.saveToTVSettings();var e=TVSettings.getJSON(this._settingsPrefix+"."+u.layoutKeyName,null);if(e){var i,s=[];for(i in e.widgets)s=s.concat(e.widgets[i].map((function(t){return t.id})));var n=TVSettings.keysMask(this._settingsPrefix+".widget.*.*");n&&n.forEach(function(t){var e=t.replace(this._settingsPrefix+".widget.","");-1===s.indexOf(e)&&0===t.indexOf(this._settingsPrefix+".widget.")&&(d("Settings debug","loadFromTVSettings: "+t,user.username),TVSettings.remove(t))}.bind(this))}}},M.prototype.mergeProperties=function(t){var i=TVSettings.getJSON(this._settingsPrefix+"."+u.layoutKeyName,null);if(!i)return t;i.settings&&e.extend(t,i.settings);for(var s={},n=0;n<t.pages.length;n++)for(var a=0;a<t.pages[n].widgets.length;a++){var o=t.pages[n].widgets[a],r=s[o.type]||0;i.widgets[o.type]&&i.widgets[o.type][r]&&e.extend(o,i.widgets[o.type][r]),s[o.type]=++r}return t},M.prototype.migrateFromOld=function(t){var e=TVSettings.getJSON(this._settingsPrefix+".layout-fixed",null);if(e){var i={settings:{}};"minimized"in e&&(i.settings.minimized=e.minimized),"width"in e&&(i.settings.width=e.width),"activeIndex"in e&&(i.settings.activeIndex=e.activeIndex),i.widgets={}
;for(var s=0;s<e.pages.length;s++)for(var n=e.pages[s].widgets||e.pages[s],a=0;a<n.length;a++){var o,r=n[a];r.id?(o=r.id.replace(/\..*/,""),/^news_.+/.test(o)&&(o=r.type="news",TVSettings.setJSON(this._settingsPrefix+".widget."+r.id.replace(/news_[^.]*/,"news"),TVSettings.getValue(this._settingsPrefix+".widget."+r.id)),r.id=r.id.replace(/news_[^.]*/,"news"))):(o=r.type,/^news_.+/.test(o)&&(r.properties=r.properties||{},r.properties.provider=r.type.replace(/news_([^.]*).*/,"$1"),o=r.type="news")),i.widgets[o]?i.widgets[o].push(r):i.widgets[o]=[r]}TVSettings.setJSON(this._settingsPrefix+"."+u.layoutKeyName,i)}else if(TVSettings.getJSON(this._settingsPrefix+".layout",null)){var h=this.getWidgetProperties("watchlist");if(h){i={settings:{},widgets:{watchlist:[h]}};TVSettings.setJSON(this._settingsPrefix+"."+u.layoutKeyName,i)}}e&&TVSettings.remove(this._settingsPrefix+".layout-fixed"),TVSettings.getJSON(this._settingsPrefix+".layout",null)&&TVSettings.remove(this._settingsPrefix+".layout")},M.prototype.saveToTVSettings=function(){if(this._settingsPrefix){var t=this.layout.marshal();TVSettings.setJSON(this._settingsPrefix+"."+u.layoutKeyName,t)}},M.prototype.getWidgetProperties=function(t,e){e=e||0;var i=this._settingsPrefix.replace(/\W/g,"\\$&")+".widget.",s=TVSettings.keysMask(i+t+".*");return!!(s&&s.length&&(s=s.sort())[e])&&{id:s[e].replace(i,"")}},M.prototype._onBrokerConnectionStatusChanged=function(t){0};var E={type:"news"};function L(t){this.widgetBar=t.widgetBar,this.pages=[],this.activePageIndex=new n(this.activeIndex),this.isMinimized=new n(this.minimized),t&&t.widgetBar&&Object.defineProperty(this,"widgetBar",{value:t.widgetBar,configurable:!0})}function V(t){this.widgets=[],t&&t.widgetBarLayout&&Object.defineProperty(this,"widgetBarLayout",{value:t.widgetBarLayout,configurable:!0})}function A(t){t&&t.widgetBarPage&&Object.defineProperty(this,"widgetBarPage",{value:t.widgetBarPage,configurable:!0}),this._internalState={alive:new n(!0),container:new n,width:new n,height:new n,detachable:new n(!1)},this._rdState=new f.ResizerDetacherState(this._internalState),this._rdState.owner.subscribe(function(t){t!==this._internalState&&e(this._internalState.container.value()).empty()}.bind(this)),this.widgetActive=new n,this.widgetMaximized=new n,this._widgetStarted=new a,this._preloadTimeout=null}function I(t){t&&t.settingsKey&&(this._settingsKey=t.settingsKey,this._value=TVSettings.getJSON(this._settingsKey,null)),t&&t.widgetBarWidget&&Object.defineProperty(this,"widgetBarWidget",{value:t.widgetBarWidget,configurable:!0})}function z(){return s.enabled("right_toolbar")}M.prototype.getGenericLayoutState=function(t){var e=u.getDefaultState(),i=window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE;i.default=i.en;for(var n=[{_gaEvent:"General Widget",title:o("Watchlist, details and news"),name:"base",icon:"base",widgets:[{type:"watchlist",properties:t&&t.length?{list:t}:void 0},{type:"detail"},Object.assign({},E,{isEnabled:!0})]},s.enabled("alerts")?{_gaEvent:"Alerts",title:o("Alerts"),name:"alerts",icon:"alarm-clock",widgets:[{
type:"alerts_manage",properties:{}},{type:"alerts_log",properties:{}}]}:null,null,null,{_gaEvent:"Data Window",title:o("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow"}]},{_gaEvent:"Hotlists",title:o("Hotlists"),name:"hotlist",icon:"hotlists",widgets:[{type:"hotlist",properties:{exchangeByLocale:i,groupByLocale:{default:"volume_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:i,groupByLocale:{default:"percent_change_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:i,groupByLocale:{default:"percent_change_loosers"}}}]},{_gaEvent:"Calendar",title:o("Calendar"),name:"calendar",icon:"calendar",widgets:[{type:"reuters_calendar",properties:{}},{type:"earnings_calendar",properties:{}}]},{_gaEvent:"My Ideas",title:o("My Ideas"),name:"notes",icon:"notes",spaceBottom:!0,spaceBottomText:o("Social"),widgets:[{type:"notes"}]},{_gaEvent:"Public Chats",title:o("Public Chats"),name:"chats",icon:"chat",widgets:[{type:"chat"},{type:"publicchats"}]},{_gaEvent:"Private Chats",title:o("Private Chats"),name:"pm_chats",icon:"messages",widgets:[{type:"messages"}]},{_gaEvent:"Ideas Stream",title:o("Ideas Stream"),name:"ideas_stream",icon:"ideas-stream",widgets:[{type:"notifications_following"}]},null,{_gaEvent:"Notifications",title:o("Notifications"),name:"notifications",icon:"notifications",widgets:[{type:"notifications_user"}]}],a=0;a<n.length;a++)n[a]&&e.pages.push(n[a]);return e},M.prototype.getChartingPlatformLayoutState=function(t,e){var i={version:2,width:267,pages:[]};if(this._customization.watchlist||this._customization.details||this._customization.news){var n="",a=[];this._customization.watchlist&&(n=o("Watchlist"),a.push({type:"watchlist",id:"watchlist."+e,properties:t&&t.length?{list:t}:void 0})),this._customization.details&&(n=this._customization.watchlist?o("Watchlist and details"):o("Details"),a.push({type:"detail"})),this._customization.news&&(n=this._customization.watchlist&&this._customization.details?o("Watchlist and details and news"):this._customization.watchlist?o("Watchlist and news"):o("News"),a.push({type:"news",id:"news."+e})),i.pages.push({name:"base",title:n,icon:"base",widgets:a})}return this._customization.datawindow&&i.pages.push({title:o("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow"}]}),s.enabled("right_toolbar")&&s.enabled("show_object_tree")&&this.chartWidgetCollection&&!this.chartWidgetCollection.readOnly()&&i.pages.push({title:o("Show Object tree"),name:"object_tree",icon:"object-tree",onBottom:!1,widgets:[{type:"object_tree"}]}),i},M.prototype.getLayoutState=function(){var t,i=this,n=TVSettings.getJSON("watchlist.list",[]);function a(t){return!(void 0!==t.isEnabled&&!t.isEnabled)&&(i.chartWidgetCollection||!M.widgetConfig[t.type].chartWidgetRequired)}for(var o=(t=s.enabled("trading_terminal")?this.getChartingPlatformLayoutState(n,"terminal"):this.getGenericLayoutState(n)).pages.length-1;o>=0;o--){var r=t.pages[o];r.widgets=e.grep(r.widgets,a)}return t.pages=e.grep(t.pages,(function(t){return t.widgets&&t.widgets.length})),t},
M.prototype.createWidgetId=function(t){return t+"."+c.randomHash()},M.prototype.setPage=function(t){this.layout.setMinimizedState(!1);var e=this.layout.activeIndex;return this.layout.pages.forEach((function(i,s){i.name===t&&(e=s)})),this.layout.switchPage(e),this.layout.getActivePage()},L.prototype.startWidgets=function(){this.pages.forEach((function(t){t.widgets.forEach((function(t){t.widgetObject||t.widgetStartDelayed||setTimeout((function(){t.startWidget()}),0)}))}));var t=this.getActivePage();t&&t.onActiveStateChange(!0)},L.prototype.syncHeight=function(){var t=this.widgetBar.resizerBridge.height.value();if(this.$pages.css("height",t+"px"),!this.minimized){var e=this.getActivePage();e&&e.updateWidgetsHeight()}},L.prototype.tabsWidth=function(){return z()?u.tabsWidth:this.minimized?u.hiderGapWidth:0},L.prototype.borderWidth=function(){return u.borderWidth},L.prototype.canOpen=function(){return this.MIN_WIDTH+this.tabsWidth()+this.borderWidth()<=this.widgetBar.resizerBridge.availWidth.value()},L.prototype.requestWidth=function(t){var e=this.widgetBar.resizerBridge;t>0&&(t+=this.borderWidth());var i=this.tabsWidth(),s=t+i;this.canOpen()?e.width.value()!==s&&e.negotiateWidth([{min:i,max:i},{min:this.MIN_WIDTH+i,max:s}]):e.negotiateWidth(0)},L.prototype.requestOptimalWidth=function(){this.changeWidgetsButtonTitle(),this.minimized?this.requestWidth(0):this.requestWidth(this.width)},L.prototype.updateResponsiveness=function(){var t=!this.canOpen();this.$tabs.toggleClass("js-hidden",t),this.$pages.toggleClass("js-hidden",t)},L.prototype.syncWidth=function(){var t=this.widgetBar.resizerBridge,e=this.tabsWidth(),i=this.borderWidth(),s=t.width.value(),n=Math.max(s-e-i,0)||0;if(n<this.MINIMIZE_THRESHOLD?this.setMinimizedState(!0):this.setMinimizedState(!1),this.$pages.css("width",n+"px").toggleClass("hidden",!!this.minimized),!this.minimized){var a=this.getActivePage();a&&a.widgets.forEach((function(t){t.onWidthChange(n)})),this.widgetBar&&this.widgetBar.loadWidgets()}var o=!this.canOpen();this.$deviceButton&&this.$deviceButton.toggleClass("js-hidden",!o||!this.minimized)},L.prototype.setMinimizedState=function(t){t=!!t,!!this.minimized!==t&&(this.minimized=t,this.isMinimized.setValue(this.minimized),t&&this.widgetBar.resizerBridge.exitFullscreen(),this.requestOptimalWidth(),this.activeIndex>=0&&this.pages[this.activeIndex].onActiveStateChange(!this.minimized))},L.prototype.getWidgetsButtonTitle=function(){return this.minimized?window.t("Show Widgets"):window.t("Hide Widgets")},L.prototype.changeWidgetsButtonTitle=function(){this.widgetBar.$widgetBarBtn&&this.widgetBar.$widgetBarBtn.attr("title",this.getWidgetsButtonTitle())},L.prototype.switchPage=function(t){if(-1===t||0===this.pages.length)return this.activeIndex=-1,void this.activePageIndex.setValue(this.activeIndex);var e;if(t instanceof V){if(-1===(e=this.pages.indexOf(t)))return}else e=+t;var i=this.pages[this.activeIndex];this.activeIndex=Math.min(this.pages.length-1,Math.max(0,e)),this.activePageIndex.setValue(this.activeIndex);var s=this.pages[this.activeIndex]
;this.activeName=s.name,this.minimized||i&&i===s||(i&&i.onActiveStateChange(!1),s&&s.onActiveStateChange(!0))},L.prototype.getActivePage=function(){return this.minimized?null:this.pages[this.activeIndex]||null},L.prototype.onTabClick=function(t,e){if(!t.isDefaultPrevented()){var i=this.pages.indexOf(e);-1!==i&&(t.preventDefault(),i!==this.activeIndex||this.minimized?(e._gaEvent&&d("Platform Widgets",e._gaEvent),this.switchPage(i),this.minimized&&this.setMinimizedState(!1)):this.setMinimizedState(!0),this.widgetBar&&this.widgetBar.saveToTVSettings())}},M.prototype.ensureSupportTicketButtonViewModel=function(){return this._supportTicketButtonViewModel?this._supportTicketButtonViewModel:this._supportTicketButtonViewModel=new _({icon:i("5qsH"),hint:window.t("Help Center"),onClick:()=>{this._configuration.then(t=>{var e=t.showSupportDialog;e&&e()}),this._load()}})},M.prototype.ensureHelpButtonViewModel=function(){if(this._helpButtonViewModel)return this._helpButtonViewModel;var t=this.ensureSupportTicketButtonViewModel();return this._helpButtonViewModel=new _({icon:i("1WEt"),hint:o("Help Center"),onClick:t.onClick.value()})},L.prototype.onLayoutResizeHandleMousedown=function(t){if(!t.isDefaultPrevented()){t.preventDefault();var i,s=this,n=Math.max(this.widgetBar.resizerBridge.width.value()-this.tabsWidth()-this.borderWidth(),0);i=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX,e(document.documentElement).on("mousemove touchmove",a).on("mouseup touchend",(function t(i){e(document.documentElement).off("mousemove touchmove",a).off("mouseup touchend",t),s.widgetBar&&s.widgetBar.saveToTVSettings(),s.changeWidgetsButtonTitle()}))}function a(t){var e;e=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX;var a=n-(e-i);a<s.MINIMIZE_THRESHOLD?a=0:a<s.MIN_WIDTH&&(a=s.MIN_WIDTH),a>0&&(s.width=a),s.requestWidth(a)}},L.prototype.removePage=function(t){var e=this.pages.indexOf(t);-1!==e&&(delete t.widgetBarLayout,this.pages.splice(e,1),t.$page.detach(),t.$page.detach(),t.$tab.detach(),this.activeIndex===e&&this.switchPage(e-1))},L.prototype.createPage=function(){var t=new V({widgetBarLayout:this});return this.pages.push(t),t.createHTML(),this.$pagescontent.append(t.$page),t},L.prototype.createWidget=function(t,e){if(e){if(-1===this.pages.indexOf(e))return null}else e=this.createPage();var i=new A({widgetBarPage:e});return i.demarshal({type:t}),i.createHTML(),e.attachWidget(i),i},L.prototype.widgetInsertionDisallowed=function(t){return"watchlist"===t&&((!window.user||!user.is_pro)&&(!!this.pages.some((function(e){return e.widgets.some((function(e){return e.type===t}))}))||void 0))},L.prototype.onVisibilityChange=function(){var t=!(!this.widgetBar||!this.widgetBar.resizerBridge.visible.value());this.visible=t,this.pages.forEach((function(e){e.onVisibilityChange(t)}))},L.prototype.destroy=function(){if(this.widgetBar&&this.widgetBar.layout===this&&delete this.widgetBar.layout,this.tabRenderer&&(this.tabRenderer.destroy(),this.tabRenderer=null),this.$hider){var t=this.$hider.get(0)
;v.unmountComponentAtNode(t)}for(var i=this.pages.length;i--;)for(var s=this.pages[i],n=s.widgets.length;n--;)s.widgets[n].destroy();for(var a in this)this[a]instanceof e&&this[a].remove(),delete this[a]},L.prototype.getWidgetBarOption=function(){if(this.widgetBar&&name in this.widgetBar)return this.widgetBar[name]},L.prototype.MIN_WIDTH=200,L.prototype.MINIMIZE_THRESHOLD=50,L.prototype.width=290,L.prototype.minimized=!s.enabled("show_right_widgets_panel_by_default"),L.prototype.activeIndex=0,L.prototype.activeName="",L.prototype.visible=!0,V.prototype.onActiveStateChange=function(t){t=!!t,e(this.$page).toggleClass("active",!!t),this.tab.onActiveStateChange(t),t&&this.updateWidgetsHeight({skipIfHeightUnchanged:!0}),this.widgets.forEach((function(e){e.onActiveStateChange(t)}))},V.prototype.updateWidgetsHeight=function(t){if(!this.$page)return;if(!this.widgetBarLayout||!this.widgetBarLayout.widgetBar)return;if(this.widgetBarLayout.getActivePage()!==this)return void(this._invalidated=!0);t=t||{};var e=this.widgetBarLayout.widgetBar.resizerBridge.height.value();if(this._pageHeight===e&&t.skipIfHeightUnchanged||(this._invalidated=!0,this._pageHeight=e),!this._invalidated)return;var i,s=e,n=0,a=this.widgets,o=null;const r=a.every(t=>null===t.heightRatio||0===t.heightRatio);for(var h=this.widgets.length;h--;)if(this.widgets[h].widgetMaximized.value()){o=this.widgets[h];break}if(a.length>0&&null===o&&r){const t=a[a.length-1];t.heightRatio=1,o=t}if(o){for(h=this.widgets.length;h--;){(u=a[h])!==o&&u.setHeight(0)}a=[o]}for(h=a.length-1;h>0;h--){s-=(u=a[h]).widgetConfig&&u.widgetConfig.margin||1}for(h=a.length;h--;){(u=a[h]).$widget&&(void 0===i&&(i=u.$header.outerHeight(!0)),s-=i,n+=u.heightRatio)}var l=s/n,d=a.length-1;for(h=0;h<=d;h++){var c,u=a[h];c=h===d?s:Math.round(l*u.heightRatio),u.setHeight(c),s-=c}},V.prototype.onWidgetResizeHandleMousedown=function(t,i){if(!t.isDefaultPrevented()){var s,n,a,o=this;t.preventDefault();for(var r=this.widgets.length-1;r>0;r--)this.widgets[r]===i&&(s=this.widgets[r],n=this.widgets[r-1]);a=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY;var h=n._rdState.bridge().height.value(),l=n.heightRatio+s.heightRatio,d=h+s._rdState.bridge().height.value();if(0!==d){var c,u=function(t){o.$page.addClass("widget-resize-mode");var e=(t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY)-a,i=Math.max(0,Math.min(h+e,d));c!==i&&(c=i,n.heightRatio=i/d*l,s.heightRatio=l-n.heightRatio,n.setHeight(i),s.setHeight(d-i))},g=function(t){e(document.documentElement).off("mousemove touchmove",u).off("mouseup touchend",g),o.$page.removeClass("widget-resize-mode"),c!==h&&(o.normalizeRatios(),o.widgetBarLayout&&o.widgetBarLayout.widgetBar&&o.widgetBarLayout.widgetBar.saveToTVSettings())};e(document.documentElement).on("mousemove touchmove",u).one("mouseup touchend",g)}}},V.prototype.normalizeRatios=function(){for(var t=1/0,e=this.widgets.length;e--;){var i=this.widgets[e].heightRatio;i<=0||!isFinite(i)||i<t&&(t=i)}if(isFinite(t)){for(var s=1;t<1;)t*=2,s*=2;for(;t>=2;)t/=2,s/=2
;for(e=this.widgets.length;e--;)this.widgets[e].heightRatio*=s}},V.prototype.attachWidget=function(t,e){e=+e;var i=this.widgets.indexOf(t);-1!==i?this.widgets.splice(i,1):t.widgetBarPage&&t.widgetBarPage!==this&&t.widgetBarPage.removeWidget(t),e<this.widgets.length?e<0&&(e=0):e=this.widgets.length,delete t.widgetBarPage,Object.defineProperty(t,"widgetBarPage",{value:this,configurable:!0}),this.widgets.splice(e,0,t);var s=this.widgets[e+1];s?t.$widget.insertBefore(s.$widget):t.$widget.appendTo(this.$page),this.widgetBarLayout&&this.widgetBarLayout.getActivePage(),this.updateWidgetsHeight(),t.updateVisibleWatchedValue()},V.prototype.removeWidget=function(t){var e=this.widgets.indexOf(t);-1!==e&&(delete t.widgetBarPage,this.widgets.splice(e,1),t.$widget&&t.$widget.detach(),this.updateWidgetsHeight())},V.prototype.remove=function(){this.widgetBarLayout&&this.widgetBarLayout.removePage(this)},V.prototype.destroy=function(){for(var t in this.remove(),this)this[t]instanceof e&&this[t].remove(),delete this[t]},V.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},V.prototype.onVisibilityChange=function(t){var e=t&&this.widgetBarLayout&&this.widgetBarLayout.getActivePage()===this;this.widgets.forEach((function(i){var s=i.getWidgetBarOption("widgetConfig")[i.type];e&&!s.doNotClearNotificationsOnVisibilityChange&&i.clearNotifications(),i.onVisibilityChange(t)}))},V.prototype.notify=function(t,e){!0!==(e=e||{}).clear?e.stopHighlightTab||(this.notificationCounter=this.notificationCounter+(~~t||1),this.updateNotifications(e.notificationValue)):this.clearNotifications()},V.prototype.clearNotifications=function(){this.notificationCounter=0,this.tab.updateNotifications(this.notificationCounter)},V.prototype.updateNotifications=function(t){var e="number"==typeof t?t:this.notificationCounter;this.tab.updateNotifications(e)},V.prototype.notificationCounter=0,V.prototype.getWidgets=function(t){for(var e=[],i=0;i<this.widgets.length;++i){var s=this.widgets[i];s.type===t&&e.push(s)}return e},A.prototype.setHeight=function(t){e(this._internalState.container.value())&&e(this._internalState.container.value()).height(t),this._internalState.height.setValue(t)},A.prototype.onWidthChange=function(t){this._internalState.width.setValue(t)},A.prototype.remove=function(){this.widgetBarPage&&this.widgetBarPage.removeWidget(this)},A.prototype.destroy=function(){for(var t in this.widgetObject&&"function"==typeof this.widgetObject.destroy&&this.widgetObject.destroy(),this.remove(),this.symbolLinking&&(this.symbolLinking.destroy(),this.symbolLinking=null),this.intervalLinking&&(this.intervalLinking.destroy(),this.intervalLinking=null),this.widgetVisible&&(this.widgetVisible.unsubscribe(),this.widgetVisible=null),this.widgetActive&&(this.widgetActive.unsubscribe(),this.widgetActive=null),this.watchedHeight&&(this.watchedHeight.unsubscribe(),this.watchedHeight=null),this.watchedWidth&&(this.watchedWidth.unsubscribe(),this.watchedWidth=null),
this.widgetMaximized&&(this.widgetMaximized.unsubscribe(),this.widgetMaximized=null),this)this[t]instanceof e&&this[t].remove(),delete this[t];M._messageHandlers=M._messageHandlers.filter((function(t){return t.widget!==this}),this),clearTimeout(this._preloadTimeout)},A.prototype.onActiveStateChange=function(t){var e=(this.getWidgetBarOption("widgetConfig")||M.widgetConfig)[this.type];this.$icon&&this.$icon.toggleClass("active",!!t),t&&!e.doNotClearNotifications&&this.clearNotifications(),this.updateVisibleWatchedValue(),this.widgetActive.setValue(!!t)},A.prototype.toggleMaximize=function(t){if("boolean"!=typeof t)t=!this.widgetMaximized.value();else if(t===this.widgetMaximized.value())return;this.widgetMaximized.setValue(t),this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&this.widgetBarPage.widgetBarLayout.widgetBar.saveToTVSettings(),this.widgetBarPage&&this.widgetBarPage.updateWidgetsHeight()},A.prototype.startWidget=function(){if(!this.widgetObject&&!this.widgetStartDelayed){var t=(this.getWidgetBarOption("widgetConfig")||M.widgetConfig)[this.type];if(t){var i=t.ctor;if(i){var s=this;if(this.widgetVisible=this.widgetVisible||new n,this.updateVisibleWatchedValue(),t.lazyLoad&&!this.widgetVisible.value())return this.widgetStartDelayed=!0,this.widgetVisible.when((function(){delete s.widgetStartDelayed,s.startWidget(),clearTimeout(s._preloadTimeout)})),void(t.preloadDelay&&(this._preloadTimeout=setTimeout((function(){i.preload&&i.preload()}),t.preloadDelay)));this.symbolLinking=h.symbol.spawn(),this.intervalLinking=h.interval.spawn();var a=this._rdState.bridge(),o={$widget:this.$widget,$header:this.$header,$headerspace:this.$headerspace,$body:e(a.container.value()),header:this.$header[0],widget:this.$widget[0],container:a.container.value(),properties:this.properties,notify:this.notify.bind(this),clearNotifications:this.clearNotifications.bind(this),visible:this.widgetVisible.readonly(),active:this.widgetActive.readonly(),symbol:this.symbolLinking,interval:this.intervalLinking,height:a.height,width:a.width,setTitle:this.setTitle.bind(this),setTitleHtml:this.setTitleHtml.bind(this),id:this.id,toggleMaximize:this.toggleMaximize.bind(this),maximized:this.widgetMaximized.readonly(),postMessage:M.postMessage.bind(this),onMessage:M.onMessage.bind(this),offMessage:M.offMessage.bind(this),hideDetach:!1,unAuthEditable:this.unAuthEditable};if(t.chartWidgetAllowed){var r=function(){return s.widgetBarPage&&s.widgetBarPage.widgetBarLayout&&s.widgetBarPage.widgetBarLayout.widgetBar&&s.widgetBarPage.widgetBarLayout.widgetBar.chartWidgetCollection};o.getChartWidget=function(){var t=r();return t?t.activeChartWidget.value():null},o.getChartWidgetCollection=function(){return r()||null}}null!=this.readonly?this.readonly&&(o.readonly=!0):this.getWidgetBarOption("readonly")&&(o.readonly=!0),null!=t.options&&(o.options=t.options),null!=this.stateData?o.data=this.stateData:null!=t.data&&(o.data=t.data);var l=this.widgetObject=new i(o)
;l.hasLifecycle&&this.widgetActive.readonly().subscribe((function(t){t?l.mount():l.unmount()}),{callWithLast:!t.lazyLoad}),this._widgetStarted.fire(this)}}}},A.prototype.widgetStarted=function(){return this._widgetStarted},A.prototype.notify=function(t,e){if(e=e||{},this.widgetBarPage&&(!this.widgetBarPage.isActiveAndVisible()||e.force))return this.widgetBarPage.notify(t,e)},A.prototype.clearNotifications=function(){if(this.widgetBarPage)return this.widgetBarPage.clearNotifications()},V.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},A.prototype.onVisibilityChange=function(t){this.updateVisibleWatchedValue()},A.prototype.updateVisibleWatchedValue=function(){this.widgetVisible&&this.widgetVisible.setValue(!!this.widgetBarPage&&this.widgetBarPage.isActiveAndVisible())},A.prototype.setTitle=function(t){this.customTitle=t+"",this.$title&&this.$title.text(this.getTitle())},A.prototype.setTitleHtml=function(t){this.$title&&this.$title.html(t)},A.prototype.heightRatio=1,A.prototype.getWidgetBarOption=function(t){if(this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&t in this.widgetBarPage.widgetBarLayout.widgetBar)return this.widgetBarPage.widgetBarLayout.widgetBar[t]},I.prototype.value=function(t){return this._value},I.prototype.setValue=function(t,e){return this._value=t,this._settingsKey&&(null==t?(d("Settings debug","WigdetProperties.setValue: "+this._settingsKey,user.username),TVSettings.remove(this._settingsKey)):TVSettings.setJSON(this._settingsKey,t,e)),this._value},M.prototype.createHTML=function(){var t=this.$container;!t||t.size()<1||(t.empty(),this.layout.createHTML(),this.$wrap=e(document.createElement("div")).attr("class","widgetbar-wrap unselectable js-right-boundary").appendTo(t),this.layout.$pages.appendTo(this.$wrap),z()&&this.layout.$tabs.appendTo(this.$wrap),this.layout.$deviceButton&&this.$wrap.append(this.layout.$deviceButton),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap))},L.prototype._tabRendererOptions=function(){var t=this.widgetBar._internal;return{tabs:this.pages,isDomButtonAvailable:t.isDomButtonAvailable(),isOrderPanelButtonAvailable:t.isOrderPanelButtonAvailable(),isSupportTicketButtonAvailable:t.isSupportTicketButtonAvailable(),isHelpButtonAvailable:t.isHelpButtonAvailable()}},L.prototype.updateRightToolbar=function(){this.tabRenderer.updateOptions(this._tabRendererOptions())},L.prototype.createHTML=function(){var t=this;if(t.$tabs=t.$tabscontent=e(),z()&&(t.$tabs=e('<div class="widgetbar-tabs">'),t.tabRenderer&&(t.tabRenderer.destroy(),t.tabRenderer=null),t.tabRenderer=new m(t.widgetBar,t.$tabs[0],t._tabRendererOptions())),t.$pages=e(document.createElement("div")).attr("class","widgetbar-pages"),t.$pagescontent=e(document.createElement("div")).attr("class","widgetbar-pagescontent").appendTo(t.$pages),z()||t.$pages.css("right","-1px"),t.$handle=e(document.createElement("div")).attr("class","widgetbar-handle").appendTo(t.$pages),
t.$handle.on("mousedown touchstart",t.onLayoutResizeHandleMousedown.bind(t)),t.$handle.on("contextmenu",(function(t){t.target.classList.contains("widgetbar-handle")&&t.preventDefault()})),this.widgetBar.showCloseButton){t.$hider=e(document.createElement("div")).addClass("widgetbar-hider");var i=function(){var e=t.$hider.get(0);e.classList.toggle("widgetbar-hider--closed",t.isMinimized.value()),e.classList.toggle("js-hidden",z()&&t.isMinimized.value()),v.render(b.createElement(w,{isMinimized:t.isMinimized.value(),onClick:function(){t.setMinimizedState(!t.minimized)}}),e)};t.isMinimized.subscribe(i),i()}t.pages.forEach((function(e){e.createHTML(),e.$page.appendTo(t.$pagescontent)}))},V.prototype.createHTML=function(){var t=this;t.$page=e(document.createElement("div")).attr("class","widgetbar-page"),t.widgets.forEach((function(e){e.createHTML(),e.$widget.appendTo(t.$page)}))},V.prototype.createTabButtonViewModel=function(){var t=this;t.tab=new _({icon:M.svgIcons[t.icon],hint:t.title,onClick:function(e){t.widgetBarLayout&&t.widgetBarLayout.onTabClick(e,t)},TabButtonComponent:t.TabButtonComponent})},A.prototype.getTitle=function(t){var e,i,s,n=(e=this.type,i=this.getWidgetBarOption("widgetConfig"),!(s=((i=i||M.widgetConfig)[e]||0).title)&&e&&(s=(""+e).match(/[A-Z]{2,}|\d+(?:\.\d+)?|[A-Z]?[a-z]+/g).join(" ").replace(/^.|\s./g,(function(t){return t.toUpperCase()}))),s||void 0);return t&&this.customTitle&&n?this.customTitle.substr(0,n.length)===n?this.customTitle:n+": "+this.customTitle:this.customTitle||n||o("Widget")},A.prototype.createHTML=function(){var t=this,i=!!t.widgetConfig&&(!!t.widgetConfig.icon&&t.widgetConfig.icon),s=t.widgetConfig&&t.widgetConfig.emptyHeader,n=t.widgetConfig&&t.widgetConfig.noHeader,a=t.widgetConfig&&t.widgetConfig.noHeaderSpace,o=t.widgetConfig&&t.widgetConfig.widgetClass||"",r=t.widgetConfig&&t.widgetConfig.headerClass||"",h=t.widgetConfig&&t.widgetConfig.titleClass||"";t.$widget=e(document.createElement("div")).attr("class",g(o,"widgetbar-widget","widgetbar-widget-"+t.type)),t.$header=e(document.createElement("div")).attr("class",r||"widgetbar-widgetheader"),n||t.$header.appendTo(t.$widget),t.$header.on("contextmenu",(function(t){"input"!==t.target.tagName.toLowerCase()&&t.preventDefault()})),i&&(t.$headericon=e(document.createElement("div")).attr("class","widgetbar-widgetheader-icon widgetbar-widgetheader-icon-"+i).append(e(M.svgIcons[i])).appendTo(t.$header)),a||(t.$headerspace=e(document.createElement("div")).attr("class","widgetbar-headerspace").appendTo(t.$header),t.$headerspace.on("click",(function(t){t.preventDefault()}))),s||(t.$title=e(document.createElement("div")).attr("class",g("widgetbar-widgettitle",h)).attr("data-name",t.type+"_header").appendTo(t.$header),t.$title.text(this.getTitle()));var l=e(document.createElement("div")).attr("class","widgetbar-widgetbody").appendTo(t.$widget);l.on("contextmenu",(function(t){t.target.classList.contains("widgetbar-widgetbody")&&t.preventDefault()})),t._internalState.container.setValue(T(l)),
t.$resizehandle=e(document.createElement("div")).attr("class","widgetbar-widgethandle").appendTo(t.$widget),t.$resizehandle.on("mousedown touchstart",(function(e){t.widgetBarPage&&t.widgetBarPage.onWidgetResizeHandleMousedown(e,t)})),t.$resizehandle.on("contextmenu",(function(t){t.target.classList.contains("widgetbar-widgethandle")&&t.preventDefault()})),!0===this.maximized&&(this.toggleMaximize(!0),delete this.maximized)},L.demarshal=function(t,e){return(new L).demarshal(t,e)},V.demarshal=function(t,e){return(new V).demarshal(t,e)},A.demarshal=function(t,e){return(new A).demarshal(t,e)},L.prototype.demarshal=function(t,e){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if(!t||"object"!=typeof t)return null;this.width=+t.width,!isFinite(this.width)||this.width<=0?delete this.width:this.width<this.MIN_WIDTH&&(this.width=this.MIN_WIDTH),"minimized"in t?(this.minimized=!!t.minimized,this.isMinimized.setValue(this.minimized)):(delete this.minimized,this.isMinimized.setValue(this.minimized)),"version"in t&&(this.version=t.version);var i=+t.activeIndex,s=t.activeName,n=!1,a=this.pages;return a.splice(0,this.pages.length),Array.isArray(t.pages)&&t.pages.forEach((function(t,o){var r=new V({widgetBarLayout:this}).demarshal(t,e);s?t.name===s&&r&&(i=o,n=!0):r||o!==i||i--,r&&a.push(r)}),this),s&&!n&&(i=0),0===a.length?(this.activeIndex=-1,this.activePageIndex.setValue(this.activeIndex)):i>=0&&i<a.length&&(this.activeIndex=i,this.activePageIndex.setValue(this.activeIndex)),this},V.prototype.demarshal=function(t,e){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if(!t||!t.widgets||!Array.isArray(t.widgets))return null;var i=this.widgets;return i.splice(0,i.length),this._gaEvent=t._gaEvent,this.title=t.title,this.name=t.name,this.icon=t.icon,this.spaceBottom=t.spaceBottom,this.spaceBottomText=t.spaceBottomText,this.onBottom=t.onBottom,this.TabButtonComponent=t.TabButtonComponent,this.createTabButtonViewModel(),t.widgets.forEach((function(t){var s=new A({widgetBarPage:this}).demarshal(t,e);s&&i.push(s)}),this),0===i.length?null:this},A.prototype.demarshal=function(t,i){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if(!t||"object"!=typeof t)return null;var s;if("id"in t?(this.id=t.id+"",this.type=this.id.replace(/\..*/,"")):"type"in t?(this.type=t.type+"",this.id=M.prototype.createWidgetId(this.type)):(delete this.type,delete this.id),null!=t.readonly?this.readonly=!!t.readonly:delete this.readonly,this.stateData=t.data,isFinite(+t.heightRatio)&&+t.heightRatio>=0?this.heightRatio=+t.heightRatio:delete this.heightRatio,!0===t.maximized&&(this.maximized=!0),!0===t.unAuthEditable&&(this.unAuthEditable=!0),t.settingsKey)s=t.settingsKey;else if(this.id){var n=this.getWidgetBarOption("_settingsPrefix");n&&(s=n+".widget."+this.id)}this.properties=new I({widgetBarWidget:this,settingsKey:s}),null==t.properties||s&&null!==this.properties.value()||this.properties.setValue(t.properties),"news"!==this.type&&"hotlist"!==this.type||!s||this.properties.setValue(e.extend(!0,{},t.properties,this.properties.value())),
"hotlist"===this.type&&!s&&t.properties&&this.properties.setValue(t.properties),this.widgetConfig=null;var a=this.getWidgetBarOption("widgetConfig");return a[this.type]&&(this.widgetConfig=a[this.type]),this},L.prototype.marshal=function(t){var e=[];this.pages.forEach((function(i){var s=i.marshal(t);s&&(e=e.concat(s))}));for(var i={},s=0;s<e.length;s++)if(e[s].type){var n=e[s].type;e[s].id&&delete e[s].type,i[n]?i[n].push(e[s]):i[n]=[e[s]]}var a={widgets:i,settings:{}};return["minimized","width","activeIndex","version","activeName"].forEach((function(t){this[t]!==L.prototype[t]&&(a.settings[t]=this[t])}),this),a},V.prototype.marshal=function(t){var e=[];return this.widgets.forEach((function(i){var s=i.marshal(t);s&&e.push(s)})),0===e.length?null:e},A.prototype.marshal=function(t){var e={};return this.id&&(e.id=this.id),this.type&&(e.type=this.type),["heightRatio"].forEach((function(t){this[t]!==A.prototype[t]&&(e[t]=this[t])}),this),this.widgetMaximized.value()&&(e.maximized=!0),t&&t.includeWidgetProperties&&this.properties&&(e.properties=TradingView.clone(this.properties.value())),e},t.exports.WidgetBar=M}).call(this,i("P5fv"),i("Kxc7"),i("hY0g"),i("aIyQ"))},EKk7:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return l}));var s=i("q1tI"),n=i("TSYQ"),a=i("XAms"),o=i("Wz44");const r=o,h="http://www.w3.org/2000/svg";function l(t){const{direction:e,theme:i=o}=t;return s.createElement("svg",{xmlns:h,width:"9",height:"27",viewBox:"0 0 9 27",className:n(i.container,"right"===e?i.mirror:null),onContextMenu:a.a},s.createElement("g",{fill:"none",fillRule:"evenodd"},s.createElement("path",{className:i.background,d:"M4.5.5a4 4 0 0 1 4 4v18a4 4 0 1 1-8 0v-18a4 4 0 0 1 4-4z"}),s.createElement("path",{className:i.arrow,d:"M5.5 10l-2 3.5 2 3.5"})))}},FadI:function(t,e,i){"use strict";function s(t){let e=null;return(i,...s)=>(null==e||e.abort(),e=new AbortController,null==i||i.addEventListener("error",()=>null==e?void 0:e.abort(),{once:!0}),t(e.signal,...s))}function n(t){if(!h(t))throw t}function a(t){if(h(t))throw t}function o(t){return(null==t?void 0:t.aborted)?Promise.reject(r()):new Promise((e,i)=>{null==t||t.addEventListener("abort",()=>i(r()),{once:!0})})}function r(){return new DOMException("Aborted","AbortError")}function h(t){return t instanceof Error&&"AbortError"===t.name}function l(t,e){return Promise.race([o(t),e])}async function d(t,e){let i;try{await l(t,new Promise(t=>{i=setTimeout(t,e)}))}finally{clearTimeout(i)}}i.r(e),i.d(e,"respectLatest",(function(){return s})),i.d(e,"skipAbortError",(function(){return n})),i.d(e,"rethrowAbortError",(function(){return a})),i.d(e,"rejectBySignal",(function(){return o})),i.d(e,"createAbortError",(function(){return r})),i.d(e,"isAbortError",(function(){return h})),i.d(e,"respectAbort",(function(){return l})),i.d(e,"delay",(function(){return d}))},"Fb/L":function(t,e,i){"use strict";i.r(e),i.d(e,"WidgetBarInternal",(function(){return n}));var s=i("Kxc7");class n{isHelpButtonAvailable(){
return!s.enabled("widget")&&!s.enabled("charting_library_base")}isSupportTicketButtonAvailable(){return s.enabled("bugreport_button")}isDomButtonAvailable(){return s.enabled("dome_widget")}isOrderPanelButtonAvailable(){return s.enabled("order_panel")}}},GNw3:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m5 12v-1h4v1zm5-6h1v4h-1zm0 7h1v4h-1zm2-1v-1h4v1zm7 0v-1h10.5a4.5 4.5 0 0 1 4.5 4.5v14a4.5 4.5 0 0 1-4.5 4.5h-15a4.5 4.5 0 0 1-4.5-4.5V20h1v9.5a3.5 3.5 0 0 0 3.5 3.5h15a3.5 3.5 0 0 0 3.5-3.5v-14a3.5 3.5 0 0 0-3.5-3.5H19zm-3 5a1 1 0 0 0 0 2h12a1 1 0 0 0 0-2H16zm0-1h12a2 2 0 1 1 0 4H16a2 2 0 1 1 0-4zm-1 8v-1h8v1zm0 4v-1h8v1zm11-4v-1h3v1zm0 4v-1h3v1z"/></svg>'},HSWI:function(t,e,i){t.exports={filler:"filler-1ggHJ4cQ"}},IS8I:function(t,e,i){},"Ie+6":function(t,e,i){"use strict";i.r(e),i.d(e,"ObjectTreeRenderer",(function(){return o}));var s=i("eqEH"),n=i("vPbs"),a=i("ihdJ");class o{constructor(t){this._viewModel=null,this._promise=null,this._activityChangeHandler=t=>{t?this.mount():this.destroy()},this._container=t.container,t.active.value()&&this.mount(),t.active.subscribe(this._activityChangeHandler)}mount(){const t=this._promise=Promise.all([Promise.resolve().then(i.t.bind(null,"q1tI",7)),Promise.resolve().then(i.t.bind(null,"i8i4",7)),Promise.all([i.e("redux"),i.e("react"),i.e(0),i.e(2),i.e(3),i.e(5),i.e(8),i.e(9),i.e(13),i.e(26),i.e(35),i.e(47),i.e(56),i.e(65),i.e(88),i.e(1),i.e(4),i.e(24),i.e(21),i.e(46),i.e(44),i.e(59),i.e(75),i.e("object-tree-panel")]).then(i.bind(null,"p17a")),Promise.all([i.e("redux"),i.e("react"),i.e(0),i.e(2),i.e(3),i.e(5),i.e(8),i.e(9),i.e(13),i.e(26),i.e(35),i.e(47),i.e(56),i.e(65),i.e(88),i.e(1),i.e(4),i.e(24),i.e(21),i.e(46),i.e(44),i.e(59),i.e(75),i.e("object-tree-panel")]).then(i.bind(null,"uIX/")),Promise.all([i.e("redux"),i.e("react"),i.e(0),i.e(2),i.e(3),i.e(5),i.e(8),i.e(9),i.e(13),i.e(26),i.e(35),i.e(47),i.e(56),i.e(65),i.e(88),i.e(1),i.e(4),i.e(24),i.e(21),i.e(46),i.e(44),i.e(59),i.e(75),i.e("object-tree-panel")]).then(i.bind(null,"jaf/")),Object(a.b)()]).then(([e,i,a,o,r])=>{if(this._promise===t){const t=Object(s.service)(n.CHART_WIDGET_COLLECTION_SERVICE);null===this._viewModel&&(this._viewModel=new r.ObjectTree(t.activeChartWidget)),i.render(e.createElement(o.ObjectTree,{nodeRenderer:a.NodeRenderer,viewModel:this._viewModel}),this._container)}})}unmount(){this._promise=null;const t=i.c.i8i4;if(t){t.exports.unmountComponentAtNode(this._container)}}destroy(){this.unmount(),null!==this._viewModel&&(this._viewModel.destroy(),this._viewModel=null)}}},"If+W":function(t,e,i){t.exports={toolbar:"toolbar-OvhMiobx",isGrayed:"isGrayed-OvhMiobx"}},Iivm:function(t,e,i){"use strict";var s=i("q1tI");const n=s.forwardRef((t,e)=>{const{icon:i="",...n}=t;return s.createElement("span",{...n,ref:e,dangerouslySetInnerHTML:{__html:i}})});i.d(e,"a",(function(){return n}))},KkTf:function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17"><path stroke="currentColor" stroke-width="1.2" d="M1 1l15 15m0-15L1 16"/></svg>'},PW1O:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m17 30a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m6 5a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m10 5a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2"/></svg>'},Vike:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 10" width="20" height="10"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M2 1l8 8 8-8"/></svg>'},"Wh/o":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 23 16" width="23px" height="16px"><path d="M11.404 15.2c6.298 0 11.404-7.6 11.404-7.6S17.702 0 11.404 0 0 7.6 0 7.6s5.106 7.6 11.404 7.6zm-3.8-7.6c0-2.11 1.688-3.8 3.8-3.8s3.8 1.69 3.8 3.8-1.72 3.8-3.8 3.8c-2.112 0-3.8-1.69-3.8-3.8z"/></svg>'},Wz44:function(t,e,i){t.exports={container:"container-3CL4Geq2",mirror:"mirror-3CL4Geq2",background:"background-3CL4Geq2",arrow:"arrow-3CL4Geq2"}},YvYu:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="45" height="45"><path fill="currentcolor" d="M16.5 21.5l8.146 8.146a.914.914 0 0 1-1.292 1.293L16.5 24.086l-6.854 6.853a.914.914 0 0 1-1.292-1.293L16.5 21.5zm0 4l6.146 6.146a1.914 1.914 0 0 0 2.708-2.707L16.5 20.086l-8.854 8.853a1.914 1.914 0 1 0 2.708 2.707L16.5 25.5zm13 0l8.146-8.146a.914.914 0 0 0-1.292-1.293L29.5 22.914l-6.854-6.853a.914.914 0 0 0-1.292 1.293L29.5 25.5zm0-4l6.146-6.146a1.914 1.914 0 0 1 2.708 2.707L29.5 26.914l-8.854-8.853a1.914 1.914 0 1 1 2.708-2.707L29.5 21.5z"/></svg>'},"aE/C":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M22.308 8.606a.5.5 0 0 0-.616 0l-11.5 9a.5.5 0 0 0 0 .788l11.5 9a.5.5 0 0 0 .616 0l11.5-9a.5.5 0 0 0 0-.788l-11.5-9zM22 26.366L11.311 18 22 9.635 32.689 18 22 26.365zm0 4l-11.192-8.76-.616.788 11.5 9a.5.5 0 0 0 .616 0l11.5-9-.616-.788L22 30.366zm0 4l-11.192-8.76-.616.788 11.5 9a.5.5 0 0 0 .616 0l11.5-9-.616-.788L22 34.366z"/></svg>'},ai7J:function(t,e,i){t.exports={separator:"separator-3YbwEKtL"}},b5Gw:function(t,e,i){"use strict";i.r(e),i.d(e,"makeCancelable",(function(){return n})),i.d(e,"isCancelled",(function(){return a}));class s{}function n(t){let e=!1;return{promise:new Promise((i,n)=>{t.then(t=>e?n(new s):i(t)),t.catch(t=>n(e?new s:t))}),cancel(){e=!0}}}function a(t){return t instanceof s}},dCE3:function(t,e,i){t.exports={button:"button-2OmDro4I",
icon:"icon-2OmDro4I"}},dECE:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m29.5 11a4.5 4.5 0 0 1 4.5 4.5v14a4.5 4.5 0 0 1-4.5 4.5h-15a4.5 4.5 0 0 1-4.5-4.5v-14a4.5 4.5 0 0 1 4.5-4.5m0 1a3.5 3.5 0 0 0-3.5 3.5v14a3.5 3.5 0 0 0 3.5 3.5h15a3.5 3.5 0 0 0 3.5-3.5v-14a3.5 3.5 0 0 0-3.5-3.5M15 17v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z"/></svg>'},dkCg:function(t,e,i){"use strict";i.r(e);var s=i("q1tI"),n=i("i8i4"),a=i("17x9"),o=i("TSYQ"),r=i("8+VR"),h=i("Iivm"),l=i("dCE3"),d=i("KkTf");function c(t){const e=o(t.className,l.button,t.isGrayed&&l.isGrayed);return s.createElement("div",{className:e,onClick:t.onClick,"data-role":"button","data-name":t.name},s.createElement(h.a,{className:l.icon,icon:d}))}var u=i("5AaZ"),g=i("1Pr8");function p(t){t={isTab:!0,theme:g,...t};const{NotificationComponent:e=m}=t,i=o(t.className,t.theme.button,t.isTab&&t.theme.isTab,t.isActive&&t.theme.isActive,t.isGrayed&&t.theme.isGrayed,t.hint&&"apply-common-tooltip common-tooltip-vertical");return s.createElement("div",{className:i,title:t.hint,onClick:t.onClick,ref:t.reference,"data-role":"button","data-name":t.name},s.createElement("div",{className:t.theme.hoverMask}),s.createElement(h.a,{icon:t.icon}),s.createElement("div",{className:t.theme.counterRow},s.createElement(e,{className:t.theme.counter,count:t.count,"data-name":"counter"})))}function m(t){return s.createElement("span",{className:t.className,"data-name":"counter"},t.count&&0!==t.count?t.count.toString():void 0)}var _=i("vOQ2"),w=i("Eyy1"),v=i("1TxM"),b=i("PW1O");const f=window.t("DOM"),y=Object(v.b)();class C extends s.PureComponent{constructor(t,e){super(t,e),this._handleClick=()=>{const{setDomPanelVisibility:t}=Object(w.ensure)(this.context.widgetBar.tradingPanelAccessor);t(!this.state.isActive)},this._handleIsOpenedChange=()=>{this.setState({isActive:this._tradingPanel.isPageOpened(_.d.DomPanel)})},this._handleActivePageChange=t=>{this._tradingPanel.isOpened.value()&&this.setState({isActive:t===_.d.DomPanel})},Object(v.c)(e,{widgetBar:a.any.isRequired}),this._tradingPanel=Object(w.ensure)(this.context.widgetBar.tradingPanelAccessor).tradingPanel,this.state={isActive:this._tradingPanel.isPageOpened(_.d.DomPanel)}}componentDidMount(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)}componentWillUnmount(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)}render(){return s.createElement(p,{...this.props,icon:b,hint:f,isActive:this.state.isActive,onClick:this._handleClick})}}C.contextType=y;var B=i("JWMC"),S=i("YvYu");const T=window.t("Order Panel"),P=Object(v.b)();class W extends s.PureComponent{constructor(t,e){super(t,e),this._handleClick=()=>{const{setOrderPanelVisibility:t}=Object(w.ensure)(this.context.widgetBar.tradingPanelAccessor),e=!this.state.isActive;t(e),e&&Object(B.trackEvent)("GUI","Open Order Panel")},
this._handleIsOpenedChange=()=>{this.setState({isActive:this._tradingPanel.isPageOpened(_.d.OrderPanel)})},this._handleActivePageChange=t=>{this._tradingPanel.isOpened.value()&&this.setState({isActive:t===_.d.OrderPanel})},Object(v.c)(e,{widgetBar:a.any.isRequired}),this._tradingPanel=Object(w.ensure)(this.context.widgetBar.tradingPanelAccessor).tradingPanel,this.state={isActive:this._tradingPanel.isPageOpened(_.d.OrderPanel)}}componentDidMount(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)}componentWillUnmount(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)}render(){return s.createElement(p,{...this.props,icon:S,hint:T,isActive:this.state.isActive,onClick:this._handleClick})}}W.contextType=P;var x=i("ai7J");function H(t){return s.createElement("div",{className:o(t.className,x.separator)})}var O=i("HSWI");function M(t){return s.createElement("div",{className:o(O.filler,t.className)})}function E(t,e){return class extends s.PureComponent{constructor(t){super(t),this._bindedForceUpdate=()=>this.forceUpdate(),this.state={viewModel:e}}componentDidMount(){const{viewModel:t}=this.state;t.notificationsCount.subscribe(this._bindedForceUpdate),t.isActive.subscribe(this._bindedForceUpdate)}componentWillUnmount(){const{viewModel:t}=this.state;t.notificationsCount.unsubscribe(this._bindedForceUpdate),t.isActive.unsubscribe(this._bindedForceUpdate)}render(){const{viewModel:e}=this.state,i=e.notificationsCount.value();return s.createElement(t,{...this.props,icon:e.icon.value(),isActive:e.isActive.value(),onClick:e.onClick.value(),hint:e.hint.value(),count:i})}}}var L=i("XAms"),V=i("txPx"),A=i("8d0Q"),I=i("If+W");const z=Object(V.getLogger)("Platform.GUI.RightToolbar"),N=Object(v.b)();class k extends s.PureComponent{constructor(t,e){super(t,e),this._pages={},this._isTradingPanelVisible=null,this._tradingActivePage=null,this._isTradingPanelOpened=null,this._handleMouseOver=t=>{Object(A.a)(t)&&this.setState({isHovered:!0})},this._handleMouseOut=t=>{Object(A.a)(t)&&this.setState({isHovered:!1})},this._handleFullscreenChange=t=>{this.setState({isFullscreen:t})},this._handleCloseClick=()=>{const{widgetBar:t}=this.context;t.layout.setMinimizedState(!0)},this._handleGrayedChange=()=>{this.setState({isGrayed:this._isGrayed()})},this._handleDomButtonVisibilityChange=t=>{this.setState({isTradingButtonsVisible:t})},this._isGrayed=()=>{let t=this._isMinimized.value();return null!==this._isTradingPanelOpened&&(t=t&&!this._isTradingPanelOpened.value()),!t},Object(v.c)(e,{widgetBar:a.any.isRequired});const{widgetBar:i}=this.context;if(this._isMinimized=i.layout.isMinimized.spawn(),this._isFullscreen=i.resizerBridge.fullscreen.spawn(),i.tradingPanelAccessor){const t=i.tradingPanelAccessor.tradingPanel;this._isTradingPanelVisible=t.isVisible.spawn(),this._tradingActivePage=t.activePage.spawn(),this._isTradingPanelOpened=t.isOpened.spawn()}this.state={isHovered:!1,
isGrayed:this._isGrayed(),isFullscreen:this._isFullscreen.value(),isTradingButtonsVisible:!1},null!==this._isTradingPanelVisible&&(this.state={...this.state,isTradingButtonsVisible:this._isTradingPanelVisible.value()}),i.layout.pages.forEach(t=>{var e;void 0===t.name&&z.logWarn('Page does not provide required field "name"'),this._pages[t.name]=E(null!==(e=t.tab.TabButtonComponent)&&void 0!==e?e:p,t.tab)}),this._toolset=this._createToolset()}componentDidMount(){this._isFullscreen.subscribe(this._handleFullscreenChange),this._isMinimized.subscribe(this._handleGrayedChange),null!==this._isTradingPanelVisible&&this._isTradingPanelVisible.subscribe(this._handleDomButtonVisibilityChange),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.subscribe(this._handleGrayedChange)}componentWillUnmount(){this._isFullscreen.destroy(),this._isMinimized.destroy(),null!==this._isTradingPanelVisible&&this._isTradingPanelVisible.destroy(),null!==this._tradingActivePage&&this._tradingActivePage.destroy(),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.destroy()}render(){const{className:t,isDomButtonAvailable:e,isOrderPanelButtonAvailable:i}=this.props,{isHovered:n,isGrayed:a,isFullscreen:h,isTradingButtonsVisible:l}=this.state,{widgetBar:d}=this.context,g=this._toolset,p=i&&l,m=e&&l;return s.createElement(u.a,{isVisibleFade:r.mobiletouch,isVisibleButtons:!r.mobiletouch&&n,isVisibleScrollbar:!1,onMouseOver:this._handleMouseOver,onMouseOut:this._handleMouseOut},s.createElement("div",{className:o(t,I.toolbar,a&&I.isGrayed),"data-name":"right-toolbar",onContextMenu:L.a},d.adaptive&&h&&s.createElement(c,{name:"close-button",onClick:this._handleCloseClick}),this._renderPages(),(p||m)&&s.createElement(H,null),p&&s.createElement(W,{name:"order-panel-button",isGrayed:a}),m&&s.createElement(C,{name:"dom-button",isGrayed:a}),s.createElement(M,null),this._renderPages(!0),g.SupportTicketButton&&s.createElement(g.SupportTicketButton,{name:"bug-report-button",isGrayed:a,isTab:!1}),g.HelpButton&&s.createElement(g.HelpButton,{name:"help-button",isGrayed:a,isTab:!1})))}_renderPages(t){const e=[],{isGrayed:i}=this.state,{widgetBar:n}=this.context,{pages:a}=n.layout;return a.forEach(n=>{if(n.name in this._pages&&Boolean(n.onBottom)===Boolean(t)){const t=this._pages[n.name];e.push(s.createElement(t,{name:n.name,isGrayed:i,key:n.name})),n.spaceBottom&&e.push(s.createElement(H,{key:n.spaceBottomText}))}}),e}_createToolset(){const{widgetBar:t}=this.context;return{SupportTicketButton:this.props.isSupportTicketButtonAvailable?E(p,t.ensureSupportTicketButtonViewModel()):void 0,HelpButton:this.props.isHelpButtonAvailable?E(p,t.ensureHelpButtonViewModel()):void 0}}}k.contextType=N;const j={widgetBar:a.any};class R extends s.PureComponent{constructor(t){super(t),this._registry={widgetBar:this.props.widgetBar}}render(){return s.createElement(v.a,{validation:j,value:this._registry},this.props.children)}}i.d(e,"RightToolbarRenderer",(function(){return D}));class D{constructor(t,e,i){this._widgetBar=t,this._container=e,this._options=i,
this._render()}updateOptions(t){this._options=t,this._render()}destroy(){n.unmountComponentAtNode(this._container)}_render(){n.render(s.createElement(R,{widgetBar:this._widgetBar},s.createElement(k,{isDomButtonAvailable:this._options.isDomButtonAvailable,isOrderPanelButtonAvailable:this._options.isOrderPanelButtonAvailable,isHelpButtonAvailable:this._options.isHelpButtonAvailable,isSupportTicketButtonAvailable:this._options.isSupportTicketButtonAvailable})),this._container)}}},e9Yb:function(t,e,i){t.exports={"css-value-widgetbar-tabs-width":"45px","css-value-widgetbar-border-width":"1px"}},hpIU:function(t,e,i){"use strict";i.r(e),i.d(e,"Widget",(function(){return c}));var s=i("txPx"),n=i("IWXC"),a=i("hOqT"),o=i("hY0g"),r=i.n(o),h=i("ku9n");const l=Object(s.getLogger)("Platform.GUI.Widgetbar.DetailsWidget");class d extends h.a{constructor(t){super(t),this._quoteSessionScreenerMultiplexer=null,this._mounted=!1,this._headerRenderer=null,this._contentRenderer=null,this._updateHeader=()=>{this._headerRenderer&&this._headerRenderer()},this._updateContent=()=>{this._contentRenderer&&this._contentRenderer()},this._unsubscribe=t=>{t&&this._quoteSessionMultiplexer.unsubscribe(this._bridge.id,this._symbol)},this._subscribe=t=>{this._unsubscribe(this._symbol),this._symbol=t,this._headerProps.setValue({symbolName:this._symbol}),this._contentProps.setValue({source:"RightToolbar",symbol:this._symbol,widgetWidth:this._bridge.width.value()}),t&&this._quoteSessionMultiplexer.subscribe(this._bridge.id,this._symbol,this._handleQuoteSessionUpdate.bind(this))},this._handleOnConnect=()=>{this._subscribe(this._symbol)},this._handleWidgetWidthUpdate=t=>{this._contentProps.setValue({...this._contentProps.value(),widgetWidth:t})},this._bridge=t,this._quoteSessionMultiplexer=Object(n.getQuoteSessionInstance)("full"),this._symbol=t.symbol.value(),this._headerProps=new r.a({symbolName:this._symbol}),this._contentProps=new r.a({source:"RightToolbar",symbol:this._symbol,widgetWidth:this._bridge.width.value()}),this.mount()}mount(){this._mounted?l.logWarn("Mount was called on already mounted widget"):(this._mounted=!0,this._bridge.symbol.subscribe(this._subscribe,{callWithLast:!0}),this._bridge.width.subscribe(this._handleWidgetWidthUpdate),this._headerProps.subscribe(this._updateHeader),this._contentProps.subscribe(this._updateContent),this._quoteSessionMultiplexer.onConnect.subscribe(this,this._handleOnConnect),this._subscribe(this._symbol),this._load())}unmount(){this._mounted?(this._mounted=!1,this._bridge.symbol.unsubscribe(this._subscribe),this._bridge.width.unsubscribe(this._handleWidgetWidthUpdate),this._headerProps.unsubscribe(this._updateHeader),this._contentProps.unsubscribe(this._updateContent),this._quoteSessionMultiplexer.onConnect.unsubscribe(this,this._handleOnConnect),super.unmount(),this._loadModulePromise=null):l.logWarn("Unmount was called on already unmounted widget")}_load(){if(this._headerRenderer&&this._contentRenderer)return this._headerRenderer(),void this._contentRenderer()
;const t=this._loadModulePromise=Promise.all([Promise.all([i.e(47),i.e(96),i.e(112),i.e(44),i.e("symbol-details")]).then(i.bind(null,"mF3H")),Promise.all([i.e(47),i.e(96),i.e(112),i.e(44),i.e("symbol-details")]).then(i.bind(null,"TuZa")),Promise.resolve().then(i.t.bind(null,"q1tI",7)),Promise.resolve().then(i.t.bind(null,"i8i4",7))]).then(([e,i,s,n])=>{t===this._loadModulePromise&&(this._headerRenderer=()=>{n.render(s.createElement(e.DetailsHeader,{...this._headerProps.value()}),this._headerContainer)},this._contentRenderer=()=>{n.render(s.createElement(i.Details,{...this._contentProps.value()}),this._container)},this._headerRenderer(),this._contentRenderer())})}_handleQuoteSessionScreenerUpdate(t){}_handleQuoteSessionUpdate(t){if(this._symbol!==t.symbolname)return;const{average_volume:e,last_price:i,open_price:s,low_price:n,high_price:o,ask:r,bid:h,pricescale:l,volume:d,short_name:c,minmov:u,minmove2:g,fractional:p,change:m,change_percent:_,current_session:w,exchange:v,pro_name:b,type:f,sector:y,industry:C}=t.values;this._setProps({averageVolume:e,lastPrice:i,openPrice:s,lowPrice:n,highPrice:o,ask:r,bid:h,pricescale:l,volume:d,shortName:c,minMovePrimary:u,minMoveSecondary:g,fractional:p,change:m,changePercent:_,currentSession:w,exchange:v,proName:b,type:f,sector:y,industry:C,invalid:"ok"!==t.status,symbolDescription:Object(a.getTranslatedSymbolDescription)(t.values)})}_setHeaderProps(t){this._headerProps.setValue({...this._headerProps.value(),...t})}_setProps(t){this._contentProps.setValue({...this._contentProps.value(),...t})}}const c=d},ihdJ:function(t,e,i){"use strict";i("FadI");async function s(t,e,i){let s;for(let n=0;n<e;++n)try{return await t(s)}catch(t){s=t,await i(n)}throw s}async function n(t,e){return s(t,e,()=>Promise.resolve())}var a=i("txPx");i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return u}));const o=Object(a.getLogger)("DataSourcesIcons");let r=null;function h(){const t=i.c.zxD0;return t?Promise.resolve(t.exports.lineToolsIcons):i.e("line-tools-icons").then(i.bind(null,"zxD0")).then(t=>t.lineToolsIcons)}function l(){const t=i.c.EsZh;return t?Promise.resolve(t.exports.SERIES_ICONS):i.e("series-icons-map").then(i.bind(null,"EsZh")).then(t=>t.SERIES_ICONS)}let d=null;function c(){return null===d&&(d=function(){const t=n(h,2).then(t=>t).catch(t=>(o.logWarn(t),{})),e=n(l,2).then(t=>t).catch(t=>(o.logWarn(t),{}));return Promise.all([t,e])}()),d.then(t=>(r={linetool:t[0],series:t[1]},r))}function u(){return r}},jkvV:function(t,e,i){"use strict";i.r(e),i.d(e,"Hider",(function(){return h}));i("YFKU");var s=i("q1tI"),n=i("TSYQ"),a=i("EKk7");const o=window.t("Hide Tab"),r=window.t("Open Tab");function h(t){const e=n(t.className,"apply-common-tooltip","common-tooltip-vertical","common-tooltip-otl");return s.createElement("div",{className:e,onClick:t.onClick,title:t.isMinimized?r:o},s.createElement(a.b,{direction:t.isMinimized?"left":"right"}))}},nzny:function(t,e,i){},pLUm:function(t,e,i){t.exports={wrapper:"wrapper-2eb-SI2I",touch:"touch-2eb-SI2I"}},"qxI+":function(t,e,i){"use strict";i.r(e),
i.d(e,"DataWindowWidget",(function(){return b}));var s=i("Eyy1"),n=i("eJTA"),a=i("YFKU"),o=i("YmeR"),r=i("cXAR"),h=i("JjUe"),l=i("it7y"),d=i("7KDR"),c=i("5VQP"),u=i("sFgq"),g=i("gWrr"),p=i("CLNU"),m=i("qJq3"),_=i("GVHu"),w=i("Wh/o"),v=i("6ctS");class b{constructor(t){const e=t.getChartWidgetCollection();if(!e)throw new Error("ChartWidgetCollection is required");this._chartWidgetCollection=e,this._chartWidget=this._chartWidgetCollection.activeChartWidget.value(),this._views=[],this._headerBinding=[],this._boxesBinding=[];const i=this._container=document.createElement("div");i.classList.add("chart-data-window"),t.container.appendChild(i),this._scroll=new u.a(t.container,i),this.visible=t.visible.value(),this._updateChartWidget(),this._updateSource(),this._updateLayout(),this._chartWidgetCollection.activeChartWidget.subscribe(this.fullUpdate.bind(this)),t.visible.subscribe(this._onVisibilityChange.bind(this)),this._chartWidgetCollection.selectedSources.subscribe(t=>{const e=t[0];e&&this.updateHighlight({source:e,updateScroll:!0})}),t.setTitle(Object(a.t)("Data Window"))}update(){this.visible&&(this.updateHighlight(),this.updateValues())}updateHighlight(t){const e=(t||{}).source,i=!!(t||{}).updateScroll;if(!this.visible||!this._chartWidget||!this._chartWidget.hasModel())return;const s=this._chartWidget.model().hoveredSource(),n=e||this._chartWidgetCollection.selectedSources.value()[0];let a;for(let t=0;t<this._boxesBinding.length;++t){const e=this._boxesBinding[t].src,i=this._boxesBinding[t].element;if(e){const t=!(!n||e!==n);i.classList.toggle("hover",!(!s||e!==s)),i.classList.toggle("active",t),t&&(a=i)}}a&&i&&this._scroll.scrollTo(a)}updateValues(){if(!this.visible)return;const t=t=>t.visible(),e=t=>({value:t.value(),title:Object(p.clean)(t.title(),!0),color:t.color(),showColorInBox:this._showColorInBox(t.color())});for(let i=0;i<this._boxesBinding.length;++i){const s=this._boxesBinding[i];s.body.innerHTML="",s.view.items().filter(t).map(e).forEach(t=>{var e,i;const n=document.createElement("div");n.classList.add("chart-data-window-item");const o=document.createElement("div");o.classList.add("chart-data-window-item-title"),o.textContent=t.title,n.appendChild(o);const r=document.createElement("div");if(r.classList.add("chart-data-window-item-value"),n.appendChild(r),t.showColorInBox){const i=document.createElement("div");i.classList.add("real-color"),i.style.backgroundColor=null!==(e=t.color)&&void 0!==e?e:"",i.title=Object(a.t)("Color line"),r.appendChild(i),r.appendChild(document.createTextNode(t.value))}else{const e=document.createElement("span");e.style.color=null!==(i=t.color)&&void 0!==i?i:"",e.textContent=t.value,r.appendChild(e)}s.body.appendChild(n)})}for(let t=0;t<this._headerBinding.length;t++){const e=this._headerBinding[t].element;e&&(e.textContent=Object(p.clean)(this._headerBinding[t].value.header(),!0),e.title=Object(p.clean)(this._headerBinding[t].value.title(),!0))}}fullUpdate(){this._updateChartWidget(),this._updateSource(),this._updateLayout()}setSelectedSource(t){
this._chartWidget.model().selectionMacro(e=>{e.addSourceToSelection(t)})}showContextMenuForSource(t,e){t.hasContextMenu()&&(this.setSelectedSource(t),t instanceof m.Series?this._seriesContextMenu(t).then(t=>{t.show(e)}):t instanceof _.Study&&this._studyContextMenu(t).then(t=>{t.show(e)}))}createActionShow(t){const e=new d.Action({label:Object(a.t)("Show"),icon:v,checkable:!0});return e.setBinding(new o.ActionBinder(e,t.properties().visible,this._chartWidget.model(),e.getLabel())),e.getBinding().setValue(t.properties().visible.value()),e}_updateChartWidget(){const t=this._chartWidget,e=this._chartWidgetCollection.activeChartWidget.value();t&&t.removeDataWindowWidget(),e&&(this._chartWidget=e,e.setDataWindowWidget(this))}_updateSource(){if(!this.visible)return;if(this._views=[],!this._chartWidget.hasModel())return;const t=this._chartWidget.model().model().dataSources();for(let e=0;e<t.length;e++){const i=t[e].dataWindowView();i&&this._views.push(i)}}_updateLayout(){if(this.visible){this._container.innerHTML="",this._headerBinding=[];for(let t=this._boxesBinding.length-1;t>=0;t--){const e=this._boxesBinding[t];e.src&&e.src.properties().visible.unsubscribe(this,e.visibilityHandler)}this._boxesBinding=[];for(let t=0;t<this._views.length;++t){const e=this._views[t];e.items().length&&this._bindView(e)}this.updateHighlight(),this.updateValues(),this._scroll.resize()}}_bindView(t){let e;t instanceof r.a?e=t.series():(t instanceof l.StudyDataWindowView||t instanceof h.OverlayDataWindowView)&&(e=t.study());const i=Object(g.b)('<div class="box with-actions"><div class="chart-data-window-header"><span class="text"></span><div class="hover-source-icon"></div></div><div class="chart-data-window-body"></div></div>'),n=Object(s.ensureNotNull)(i.querySelector(".chart-data-window-body")),o=Object(s.ensureNotNull)(i.querySelector(".chart-data-window-header"));if(o.classList.toggle("js-hidden",!Boolean(t.header())),this._container.appendChild(i),void 0!==e){const t=e;i.classList.toggle("hidden",!t.properties().visible.value()),i.addEventListener("click",e=>{e.preventDefault(),this.setSelectedSource(t)}),i.addEventListener("contextmenu",e=>{e.preventDefault(),this._chartWidget.readOnly()||this.showContextMenuForSource(t,e)})}function d(t){return t?Object(a.t)("Hide data"):Object(a.t)("Show data")}function c(t){i.classList.toggle("hidden",!t.value()),i.querySelectorAll(".toggle-source-icon").forEach(e=>{e.title=d(t.value())})}if(t.header()&&void 0!==e){const t=e,i=document.createElement("div");i.classList.add("toggle-source-icon"),i.title=d(t.properties().visible.value()),i.innerHTML=w,i.addEventListener("click",e=>{e.stopPropagation();const i=t.properties().visible.value();this._chartWidget.model().setProperty(t.properties().visible,!i,(i?Object(a.t)("Hide"):Object(a.t)("Show"))+" "+t.title())}),o.appendChild(i),o.addEventListener("dblclick",()=>{this._chartWidget.showChartPropertiesForSource(t)})}void 0!==e&&e.properties().visible.subscribe(this,c),this._headerBinding.push({value:t,element:o.querySelector(".text")}),
this._boxesBinding.push({view:t,src:e,element:i,body:n,visibilityHandler:c})}_onVisibilityChange(t){this.visible=!!t,t&&this.fullUpdate()}_showColorInBox(t){return!!(t&&255-Object(n.rgbToGrayscale)(Object(n.parseRgb)(t))<20)}_seriesContextMenu(t){const e=this._chartWidget.actions(),i=t.properties().visible.value(),s=[e.format,i?e.seriesHide:this.createActionShow(t)];return t!==this._chartWidget.model().mainSeries()&&s.push(e.seriesRemove),c.ContextMenuManager.createMenu(s)}_studyContextMenu(t){const e=this._chartWidget.actions(),i=t.properties().visible.value();return c.ContextMenuManager.createMenu([e.format,i?e.studyHide:this.createActionShow(t),e.studyRemove])}}},sFgq:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var s=i("8+VR"),n=i("aIyQ"),a=i.n(n),o=i("ULlu"),r=i("//lZ"),h=i("fYav"),l=(i("nzny"),i("pLUm"));const d={headerHeight:0,additionalClass:"",alwaysVisible:!1,showBottomShadow:!0,scrollMarginTop:1,bubbleScrollEvent:!1};class c{constructor(t,e,i={}){if(this.scrolled=new a.a,this.scrolltoend=new a.a,this.scrolltostart=new a.a,this.visibilityCallbacks=[],this._scrollTargetTop=0,this._scrollSpeed=40,this._shadowOffset=10,this._shadowTop=null,this._shadowBottom=null,this._bottomFixed=!1,this._dragInitialized=!1,this._dragging=!1,this._draggable=null,this._atStart=!1,this._atEnd=!1,this._stickyBottom=null,this._tempIntervalID=void 0,this._animation=null,this._saved=null,this._options={...d,...i},this._wrapper=t,this._wrapper.classList.add(l.wrapper),this._content=e,this._headerHeight=this._options.headerHeight,this._scrollMarginTop=this._options.scrollMarginTop,this._scrollBar=document.createElement("div"),this._scrollBar.classList.add("sb-scrollbar","sb-scrollbar-body"),this._options.additionalClass&&this._scrollBar.classList.add(this._options.additionalClass),this._scrollBar.classList.toggle("active-always",this._options.alwaysVisible),this._scrollBarWrapper=document.createElement("div"),this._scrollBarWrapper.classList.add("sb-scrollbar-wrap"),this._touch=s.touch,this._touch)return this._content.style.position="relative",this._wrapper.classList.add(l.touch),void this._wrapper.addEventListener("scroll",()=>this._onScroll());this._wrapper.style.overflow="hidden",this._unsubscribe=(()=>{const t=()=>{this._bottomFixed||this._dragging||(this._options.alwaysVisible||this._scrollBar.classList.add("active"),this._onScroll())},e=()=>{this._bottomFixed||this._dragging||(this._options.alwaysVisible||this._scrollBar.classList.remove("active"),this._onScroll())},i=t=>{if(!t.defaultPrevented){const e=[()=>navigator.userAgent.includes("Win")&&navigator.userAgent.includes("Chrome")?1/window.devicePixelRatio:1,()=>16,()=>.8*this._wrapper.clientHeight],i=t.deltaY*e[t.deltaMode]();this.scroll(-i,1)||(t.stopPropagation(),t.preventDefault())}};return this._wrapper.addEventListener("mouseenter",t),this._wrapper.addEventListener("mouseleave",e),this._wrapper.addEventListener("wheel",i),()=>{this._wrapper.removeEventListener("mouseenter",t),this._wrapper.removeEventListener("mouseleave",e),
this._wrapper.removeEventListener("wheel",i)}})(),!1!==this._options.showTopShadow&&(this._shadowTop=document.createElement("div"),this._shadowTop.classList.add("sb-inner-shadow","top","i-invisible"),this._wrapper.appendChild(this._shadowTop)),!1!==this._options.showBottomShadow&&(this._shadowBottom=document.createElement("div"),this._shadowBottom.classList.add("sb-inner-shadow"),this._wrapper.appendChild(this._shadowBottom)),this._shadowTop&&this._headerHeight&&(this._shadowTop.style.top=this._headerHeight-this._shadowOffset+"px"),this._wrapper.appendChild(this._scrollBarWrapper),this._scrollBarWrapper.appendChild(this._scrollBar),this._onScroll()}isTouch(){return this._touch}getScrollBar(){return this._scrollBar}initDraggable(){return this._dragInitialized||(this._draggable=new h.a({axis:"y",source:this._scrollBar,containment:this._scrollBarWrapper,start:()=>{this._dragging=!0},stop:()=>{this._dragging=!1},drag:()=>{this.updateScroll()}}),this._dragInitialized=!0),this}updateScroll(){if(this._touch)return this;const t=Math.ceil(Object(o.position)(this._scrollBar).top-this._scrollMarginTop-this._headerHeight),e=this.getContainerHeightWithoutHeader(),i=Object(o.outerHeight)(this._content),s=i-e-1;return e<=0||(this._scrollTargetTop=s<=0?this._headerHeight:Math.min(-t*i/e+this._headerHeight,this._headerHeight),t+Object(o.contentHeight)(this._scrollBar)+2>=e?this.scrollToEnd():(this._content.style.top=this._scrollTargetTop+"px",this._onScroll())),this}getContainerHeightWithoutHeader(){return this._wrapper.getBoundingClientRect().height-this._headerHeight}getContainerHeight(){return this._wrapper.getBoundingClientRect().height}getContentHeight(){return this._content.getBoundingClientRect().height}updateScrollBar(){if(this._touch)return this;const t=Object(o.position)(this._content).top,e=this.getContentHeight(),i=this.getContainerHeight(),s=this.getContainerHeightWithoutHeader(),n=1+this._headerHeight,a=s-2,r=(Math.abs(t)-this._headerHeight)*a/e,h=i*i/e;return this.isContentShort()?(this._scrollBar.classList.add("js-hidden"),this._wrapper.classList.remove("sb-scroll-active")):(this._scrollBar.classList.remove("js-hidden"),this._scrollBar.style.height=h+"px",this._scrollBar.style.top=n+r+"px",this._wrapper.classList.add("sb-scroll-active"),this.initDraggable()),this}scroll(t,e){const i=Object(o.position)(this._content).top,s=Object(o.outerHeight)(this._content)-this.getContainerHeightWithoutHeader()-1,n=e||this._scrollSpeed;return s<=0||(this._scrollTargetTop=Math.max(-s+this._headerHeight,Math.min(this._headerHeight,i+t*n)),this.setContentTop(this._scrollTargetTop),this._onScroll())}animateTo(t){if(this._touch)return this;const e=Object(o.outerHeight)(this._content)-this.getContainerHeightWithoutHeader()-1;if(e<=0)return!0;this._scrollTargetTop=Math.max(-e+this._headerHeight,Math.min(this._headerHeight,-t)),this._animation&&this._animation.stop(),this._animation=Object(r.doAnimate)({duration:500,from:parseFloat(getComputedStyle(this._content).top),to:this._scrollTargetTop,onStep:(t,e)=>{this._content.style.top=e+"px"},
onComplete:()=>{this._onScroll()}})}resize(){if(this._bottomFixed)return;const t=Object(o.outerHeight)(this._content),e=Object(o.outerHeight)(this._wrapper);!this._options.vAlignBottom&&t<e?this.atStart()||this.scrollToStart():this.atEnd()?this.scrollToEnd():"number"==typeof this._stickyBottom&&this.setContentTop(Math.min(0,this._stickyBottom+Object(o.outerHeight)(this._wrapper)-Object(o.outerHeight)(this._content)))}resizeHeader(t){const e=t-this._headerHeight;this._headerHeight=t,this._scrollTargetTop+=e,this._shadowTop&&(this._shadowTop.style.top=this._headerHeight-this._shadowOffset+"px"),this.resize()}scrollTo(t,e){const i={position:"visible",areaHeight:t instanceof HTMLElement?Object(o.contentHeight)(t):0,...e};t instanceof HTMLElement&&(t=i.offsetTop||Object(o.position)(t).top);const s=Object(o.position)(this._content).top,n=this._content.getBoundingClientRect().height,a=this.getContainerHeightWithoutHeader();if(n-a-1<=0)return!0;const r=-1*(s-this._headerHeight),h=r+a;let l=0;if("visible"===i.position){if(t>r&&t+i.areaHeight<h)return!1;l=t+i.areaHeight>h?h-t-i.areaHeight:r-t}else"top"===i.position&&(l=r-t);return this.scroll(l,1),this._onScroll(),!1}scrollToEnd(){const t=Object(o.position)(this._content).top,e=Object(o.outerHeight)(this._content),i=Object(o.outerHeight)(this._wrapper),s=e>i?t+(i-(e+t))+1:1;return this.setContentTop(s),this._onScroll(),this}scrollToStart(){return this.setContentTop(this._headerHeight),this._onScroll(),this}currentPosition(){return Math.round(Object(o.position)(this._content).top)}atStart(){return Math.round(Object(o.position)(this._content).top)>=this._headerHeight}atEnd(t){"number"==typeof t&&isFinite(t)||(t=0);const e=Math.round(Object(o.position)(this._content).top),i=Math.round(Object(o.outerHeight)(this._content)),s=Math.round(Object(o.outerHeight)(this._wrapper));return i-Math.abs(e)-1<=s+t}checkContentVisibility(){this._onContentVisible()}subscribeToContentVisible(t,e,i){this.visibilityCallbacks.push({id:t,element:e,callback:i})}triggerVisibilityCallbacks(t){this._onContentVisible(t)}save(){return this._saved={top:Object(o.position)(this._content).top,height:Object(o.outerHeight)(this._content)},this}restore(){if(this._saved){if(this._saved.top===Object(o.position)(this._content).top&&this._saved.height===Object(o.outerHeight)(this._content))return this._saved=null,this;this._options.vAlignBottom&&(this._saved.top-=Object(o.outerHeight)(this._content)-this._saved.height,this._saved.top>this._headerHeight&&(this._saved.top=this._headerHeight)),this.setContentTop(this._saved.top),this._saved=null,this._onScroll(!0)}return this}fixBottom(){if(this._bottomFixed)return this;if(this._touch){const t=Object(o.outerHeight)(this._content),e=this._wrapper.scrollTop;this._tempIntervalID=setInterval(()=>{this._wrapper.scrollTop=e+(Object(o.outerHeight)(this._content)-t)},0)}else this._content.style.top="auto",this._content.style.bottom=Object(o.outerHeight)(this._wrapper)-Object(o.position)(this._content).top-Object(o.outerHeight)(this._content)+"px";return this._bottomFixed=!0,this
}releaseBottom(){return this._bottomFixed?(this._touch?clearInterval(this._tempIntervalID):(this._content.style.bottom="auto",this._content.style.top=Object(o.position)(this._content).top+"px"),this._bottomFixed=!1,this._onScroll(),this):this}setContentTop(t){return this._touch?this._options.vAlignBottom&&Object(o.outerHeight)(this._content)<Object(o.outerHeight)(this._wrapper)?(this._wrapper.style.overflowY="visible",this._content.style.position="absolute",this._content.style.bottom="0px"):(this._content.style.position="relative",this._content.style.position="auto",this._wrapper.style.overflowY="auto",this._wrapper.scrollTop=-t):this._content.style.top=t+"px",this}isContentShort(){return this.getContentHeight()<=this.getContainerHeightWithoutHeader()}destroy(){var t;this._animation&&this._animation.stop(),this._scrollBarWrapper&&this._scrollBarWrapper.remove(),this._shadowBottom&&this._shadowBottom.remove(),this._shadowTop&&this._shadowTop.remove(),this._draggable&&(this._draggable.destroy(),this._draggable=null),this._content.style.cssText="",this._wrapper.style.cssText="",null===(t=this._unsubscribe)||void 0===t||t.call(this)}_onScroll(t){this._touch||(this._content.style.bottom="auto"),this.scrolled.fire(),this._dragging&&!0!==t||this.updateScrollBar();const e=this.atStart(),i=this.atEnd();return this._shadowTop&&this._shadowTop.classList.toggle("i-invisible",!!e),this._shadowBottom&&this._shadowBottom.classList.toggle("i-invisible",!!i),this._onContentVisible(),!this._atStart&&e?(this._atStart=!0,this.scrolltostart.fire()):this._atStart&&!e&&(this._atStart=!1),!this._atEnd&&i?(this._atEnd=!0,this.scrolltoend.fire()):this._atEnd&&!i&&(this._atEnd=!1),this._options.vAlignBottom&&(this._stickyBottom=Object(o.outerHeight)(this._content)-Math.abs(Object(o.position)(this._content).top)-Object(o.outerHeight)(this._wrapper)),(this._atStart||this._atEnd)&&("function"==typeof this._options.bubbleScrollEvent?Boolean(this._options.bubbleScrollEvent()):Boolean(this._options.bubbleScrollEvent))}_contentIsVisible(t){return Object(o.position)(t.element).top>-1*this.currentPosition()}_onContentVisible(t){if(!this.visibilityCallbacks.length)return;const e=t||this._contentIsVisible.bind(this),i=[],s=this.visibilityCallbacks.filter((t,s)=>{if(!this._content.contains(t.element))return!1;const n=e(t);return n&&i.push(s),!n});i.forEach(e=>{this.visibilityCallbacks[e].callback(!!t)}),this.visibilityCallbacks=s}}},tBUM:function(t,e,i){"use strict";i.r(e),i.d(e,"WidgetBarTabButtonViewModel",(function(){return o}));var s=i("hY0g"),n=i.n(s);const a={isActive:!1,notificationCount:0};class o{constructor(t){const e={...a,...t};this.isActive=new n.a(e.isActive),this.notificationsCount=new n.a(e.notificationCount),this.icon=new n.a(e.icon),this.hint=new n.a(e.hint),this.onClick=new n.a(e.onClick),this.TabButtonComponent=t.TabButtonComponent}onActiveStateChange(t){this.isActive.setValue(t)}updateNotifications(t){this.notificationsCount.setValue(t)}}},uJ8n:function(t,e,i){t.exports={wrap:"wrap-379NmUSU",scrollWrap:"scrollWrap-379NmUSU",
noScrollBar:"noScrollBar-379NmUSU",content:"content-379NmUSU",icon:"icon-379NmUSU",scrollBot:"scrollBot-379NmUSU",scrollTop:"scrollTop-379NmUSU",isVisible:"isVisible-379NmUSU",iconWrap:"iconWrap-379NmUSU",fadeBot:"fadeBot-379NmUSU",fadeTop:"fadeTop-379NmUSU"}},vOQ2:function(t,e,i){"use strict";var s;i.d(e,"d",(function(){return s})),i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"b",(function(){return o})),function(t){t.DomPanel="domPanel",t.OrderPanel="orderPanel"}(s||(s={}));const n=400,a=315,o=451},xrkQ:function(t,e,i){t.exports={"css-value-widgets-margin":"4px",widget:"widget-1quyc-Kt",widgetHeader:"widgetHeader-1quyc-Kt",widgetTitle:"widgetTitle-1quyc-Kt",headerSpace:"headerSpace-1quyc-Kt"}}}]);